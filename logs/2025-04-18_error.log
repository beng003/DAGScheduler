2025-04-18 13:50:25.829 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 13:50:25.829 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 13:50:25.867 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 13:50:25.867 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 13:50:25.873 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 13:50:25.874 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 13:50:48.427 | 9af95e9f5f904495b554915241e3f2ac | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为list的信息成功
2025-04-18 13:51:02.896 | a7d926a4eb7741f189c8434245d09944 | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为list的信息成功
2025-04-18 13:52:09.749 | f5e247704e1f4181ac5ab607e766f553 | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为task_no_dependencies的信息成功
2025-04-18 13:52:46.404 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 13:52:46.407 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 13:52:46.466 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 13:52:46.466 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 13:52:46.475 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 13:52:46.475 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 13:54:04.778 | d534d13e476e459c82314152447ad4c1 | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为list的信息成功
2025-04-18 13:54:21.377 | 8ef5afad36db45e7aa3920c6d5f2c423 | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为list的信息成功
2025-04-18 13:55:34.462 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 13:55:34.463 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 13:55:34.496 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 13:55:34.496 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 13:55:34.501 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 13:55:34.502 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 13:55:42.367 | 96c163ec5da44877b715d84f278e64d0 | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为list的信息成功
2025-04-18 13:55:48.373 | 4a39486c012f472197d9055c273b8fda | INFO     | module_admin.controller.task_controller:get_task_list:50 - 获取成功
2025-04-18 13:57:46.938 | ca2b080114984350b10714aaa77fe765 | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为task_no_dependencies的信息成功
2025-04-18 14:01:01.048 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 14:01:01.048 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 14:01:01.084 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 14:01:01.084 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 14:01:01.090 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 14:01:01.090 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 14:09:06.490 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 14:09:06.491 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 14:09:06.544 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 14:09:06.546 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 14:09:06.555 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 14:09:06.556 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 14:10:57.485 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 14:10:57.485 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 14:10:57.509 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 14:10:57.509 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 14:10:57.513 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 14:10:57.514 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 14:11:41.579 | b2d0a02abcdf43769b4baa025fada7f0 | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为list的信息成功
2025-04-18 14:11:51.464 | 82fa61df903349cc8421bc882fc66016 | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为task_no_dependencies的信息成功
2025-04-18 14:14:32.159 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 14:14:32.159 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 14:14:32.190 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 14:14:32.190 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 14:14:32.194 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 14:14:32.195 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 14:14:59.090 |  | INFO     | config.get_redis:close_redis_pool:52 - 关闭redis连接成功
2025-04-18 14:16:50.170 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 14:16:50.171 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 14:16:50.207 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 14:16:50.207 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 14:16:50.212 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 14:16:50.213 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 14:16:54.682 | 4a0cb522c2ed4256aa096f8974e87425 | ERROR    | exceptions.handle:exception_handler:53 - 'Redis' object has no attribute 'task_uid'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x759d65b132e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x759d65c5a320>
           └ <SpawnProcess name='SpawnProcess-1' parent=426986 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x759d65c59990>
    └ <SpawnProcess name='SpawnProcess-1' parent=426986 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x759d65b17430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=426986 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=426986 started>
    │    └ <function subprocess_started at 0x759d655a7b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=426986 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x759d65b17550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x759d655a6ef0>
           │       │   └ <uvicorn.server.Server object at 0x759d65b17550>
           │       └ <function run at 0x759d65b324d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x759d6141a880>
           │    └ <cyfunction Loop.run_until_complete at 0x759d613ed700>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x759d6432ea10>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x759d60e742...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x759d60e...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x759d65b17820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x759d6432ea10>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x759d60e742...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x759d60e...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x759d60e742...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x759d60e...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x759d643a6b60>
          └ <fastapi.applications.FastAPI object at 0x759d65b17820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x759d643c91b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x759d60e...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x759d643a6bf0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x759d643a6b60>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x759d643c9360>
          │    │   │      └ <function RequestResponseCycle.receive at 0x759d643c92d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x759d643a6c20>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x759d643a6bf0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x759d643c9360>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x759d643c92d0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x759d60e74520>
          │                            │    └ <fastapi.routing.APIRouter object at 0x759d6140eef0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x759d643a6c20>
          └ <function wrap_app_handling_exceptions at 0x759d649f24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x759d643c93f0>
          │   │      └ <function RequestResponseCycle.receive at 0x759d643c92d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x759d6140eef0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x759d643c93f0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x759d643c92d0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x759d6140eef0>>
          └ <fastapi.routing.APIRouter object at 0x759d6140eef0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x759d643c93f0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x759d643c92d0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x759d649f39a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x759d643c93f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x759d643c92d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x759d6148c550>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x759d643c93f0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x759d643c92d0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x759d60e74670>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x759d643c9480>
          └ <function wrap_app_handling_exceptions at 0x759d649f24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x759d643c9510>
          │   │      └ <function RequestResponseCycle.receive at 0x759d643c92d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x759d643c9480>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x759d60e74670>
                     └ <function get_request_handler.<locals>.app at 0x759d6148c4c0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x759d64829510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x759d60e74ac0>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x759d61447880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x759d61447130>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 69, in add_task_services
    if not await cls.check_task_unique_services(query_db, page_object):
                 │   │                          │         └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   │                          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x759d60e74ac0>
                 │   └ <classmethod(<function TaskService.check_task_unique_services at 0x759d614470a0>)>
                 └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 54, in check_task_unique_services
    task_uid = -1 if page_object.task_uid is None else page_object.task_uid
                     │                                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                     └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...

AttributeError: 'Redis' object has no attribute 'task_uid'
2025-04-18 15:40:22.789 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 15:40:22.790 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 15:40:22.844 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 15:40:22.845 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 15:40:22.853 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 15:40:22.854 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 15:40:48.688 | 7810d621574f478383c0da7befce13bc | ERROR    | exceptions.handle:exception_handler:53 - 'Redis' object has no attribute 'task_uid'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 14
               └ <function _main at 0x7ab1f24f5d80>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x7ab1f24d5240>
           └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7ab1f24d48b0>
    └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7ab1f2657f10>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
    │    └ <function subprocess_started at 0x7ab1f020f2e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7ab1f2657760>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7ab1f01d1d80>
           │       │   └ <uvicorn.server.Server object at 0x7ab1f2657760>
           │       └ <function run at 0x7ab1f03df130>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7ab1d689bb50>
           │    └ <cyfunction Loop.run_until_complete at 0x7ab1d68824d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7ab1d6967190>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d66a19...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d66...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7ab1f24b4040>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7ab1d6967190>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d66a19...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d66...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d66a19...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d66...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7ab1d66a0340>
          └ <fastapi.applications.FastAPI object at 0x7ab1f24b4040>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7ab1d669bac0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d66...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7ab1d66a02b0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7ab1d66a0340>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7ab1d669be20>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7ab1d669bd90>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7ab1d66a0370>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7ab1d66a02b0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7ab1d669be20>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7ab1d669bd90>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7ab1d66a0bb0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7ab1d66a0370>
          └ <function wrap_app_handling_exceptions at 0x7ab1e267c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d669beb0>
          │   │      └ <function RequestResponseCycle.receive at 0x7ab1d669bd90>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d669beb0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7ab1d669bd90>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>>
          └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d669beb0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7ab1d669bd90>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7ab1e267d7e0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d669beb0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7ab1d669bd90>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7ab1d68e95a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d669beb0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7ab1d669bd90>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7ab1d66a1c00>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7ab1d669bf40>
          └ <function wrap_app_handling_exceptions at 0x7ab1e267c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d6508040>
          │   │      └ <function RequestResponseCycle.receive at 0x7ab1d669bd90>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7ab1d669bf40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7ab1d66a1c00>
                     └ <function get_request_handler.<locals>.app at 0x7ab1d68e9510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7ab1e267f370>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7ab1d66a2050>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7ab1d68e89d0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7ab1d68e81f0>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 69, in add_task_services
    if not await cls.check_task_unique_services(query_db, page_object):
                 │   │                          │         └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   │                          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7ab1d66a2050>
                 │   └ <classmethod(<function TaskService.check_task_unique_services at 0x7ab1d68e8160>)>
                 └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 54, in check_task_unique_services
    task_uid = -1 if page_object.task_uid is None else page_object.task_uid
                     │                                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                     └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...

AttributeError: 'Redis' object has no attribute 'task_uid'
2025-04-18 15:41:12.581 | a4c19a3b442a480e8ba8dc56656b0bdf | ERROR    | exceptions.handle:exception_handler:53 - 'Redis' object has no attribute 'task_uid'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 14
               └ <function _main at 0x7ab1f24f5d80>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x7ab1f24d5240>
           └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7ab1f24d48b0>
    └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7ab1f2657f10>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
    │    └ <function subprocess_started at 0x7ab1f020f2e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7ab1f2657760>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7ab1f01d1d80>
           │       │   └ <uvicorn.server.Server object at 0x7ab1f2657760>
           │       └ <function run at 0x7ab1f03df130>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7ab1d689bb50>
           │    └ <cyfunction Loop.run_until_complete at 0x7ab1d68824d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7ab1d6967190>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d654d1...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7ab1f24b4040>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7ab1d6967190>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d654d1...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d654d1...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7ab1d66a0340>
          └ <fastapi.applications.FastAPI object at 0x7ab1f24b4040>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7ab1d6509c60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7ab1d66a02b0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7ab1d66a0340>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7ab1d6509cf0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6509990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7ab1d66a0370>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7ab1d66a02b0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7ab1d6509cf0>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7ab1d6509990>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7ab1d654f430>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7ab1d66a0370>
          └ <function wrap_app_handling_exceptions at 0x7ab1e267c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64530a0>
          │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6509990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64530a0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7ab1d6509990>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>>
          └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64530a0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7ab1d6509990>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7ab1e267d7e0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64530a0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6509990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7ab1d68e95a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64530a0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7ab1d6509990>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7ab1d654d660>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7ab1d6453010>
          └ <function wrap_app_handling_exceptions at 0x7ab1e267c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d6453130>
          │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6509990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7ab1d6453010>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7ab1d654d660>
                     └ <function get_request_handler.<locals>.app at 0x7ab1d68e9510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7ab1e267f370>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7ab1d654dea0>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7ab1d68e89d0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7ab1d68e81f0>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 69, in add_task_services
    if not await cls.check_task_unique_services(query_db, page_object):
                 │   │                          │         └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   │                          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7ab1d654dea0>
                 │   └ <classmethod(<function TaskService.check_task_unique_services at 0x7ab1d68e8160>)>
                 └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 54, in check_task_unique_services
    task_uid = -1 if page_object.task_uid is None else page_object.task_uid
                     │                                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                     └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...

AttributeError: 'Redis' object has no attribute 'task_uid'
2025-04-18 15:42:18.100 | 6c5ceb6e19394b848bdfe022d594fc81 | ERROR    | exceptions.handle:exception_handler:53 - 'Redis' object has no attribute 'task_uid'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 14
               └ <function _main at 0x7ab1f24f5d80>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x7ab1f24d5240>
           └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7ab1f24d48b0>
    └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7ab1f2657f10>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
    │    └ <function subprocess_started at 0x7ab1f020f2e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7ab1f2657760>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7ab1f01d1d80>
           │       │   └ <uvicorn.server.Server object at 0x7ab1f2657760>
           │       └ <function run at 0x7ab1f03df130>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7ab1d689bb50>
           │    └ <cyfunction Loop.run_until_complete at 0x7ab1d68824d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7ab1d6967190>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d6522f...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7ab1f24b4040>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7ab1d6967190>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d6522f...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d6522f...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7ab1d66a0340>
          └ <fastapi.applications.FastAPI object at 0x7ab1f24b4040>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7ab1d6453400>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7ab1d66a02b0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7ab1d66a0340>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7ab1d6453c70>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6453d00>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7ab1d66a0370>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7ab1d66a02b0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7ab1d6453c70>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7ab1d6453d00>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7ab1d65232b0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7ab1d66a0370>
          └ <function wrap_app_handling_exceptions at 0x7ab1e267c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d6453be0>
          │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6453d00>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d6453be0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7ab1d6453d00>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>>
          └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d6453be0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7ab1d6453d00>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7ab1e267d7e0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d6453be0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6453d00>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7ab1d68e95a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d6453be0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7ab1d6453d00>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7ab1d6523a60>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7ab1d6453b50>
          └ <function wrap_app_handling_exceptions at 0x7ab1e267c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d6453ac0>
          │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6453d00>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7ab1d6453b50>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7ab1d6523a60>
                     └ <function get_request_handler.<locals>.app at 0x7ab1d68e9510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7ab1e267f370>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7ab1d65215a0>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7ab1d68e89d0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7ab1d68e81f0>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 69, in add_task_services
    if not await cls.check_task_unique_services(query_db, page_object):
                 │   │                          │         └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   │                          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7ab1d65215a0>
                 │   └ <classmethod(<function TaskService.check_task_unique_services at 0x7ab1d68e8160>)>
                 └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 54, in check_task_unique_services
    task_uid = -1 if page_object.task_uid is None else page_object.task_uid
                     │                                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                     └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...

AttributeError: 'Redis' object has no attribute 'task_uid'
2025-04-18 15:42:28.613 | 19e2e89c8bb84e6e9d67f82ee8db875a | ERROR    | exceptions.handle:exception_handler:53 - 'Redis' object has no attribute 'task_uid'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 14
               └ <function _main at 0x7ab1f24f5d80>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x7ab1f24d5240>
           └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7ab1f24d48b0>
    └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7ab1f2657f10>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
    │    └ <function subprocess_started at 0x7ab1f020f2e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=455311 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7ab1f2657760>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7ab1f01d1d80>
           │       │   └ <uvicorn.server.Server object at 0x7ab1f2657760>
           │       └ <function run at 0x7ab1f03df130>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7ab1d689bb50>
           │    └ <cyfunction Loop.run_until_complete at 0x7ab1d68824d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7ab1d6967190>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d654c2...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7ab1f24b4040>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7ab1d6967190>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d654c2...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d654c2...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7ab1d66a0340>
          └ <fastapi.applications.FastAPI object at 0x7ab1f24b4040>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7ab1d6453880>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ab1d65...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7ab1d66a02b0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7ab1d66a0340>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7ab1d64539a0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6453520>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7ab1d66a0370>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7ab1d66a02b0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7ab1d64539a0>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7ab1d6453520>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7ab1d654dcc0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7ab1d66a0370>
          └ <function wrap_app_handling_exceptions at 0x7ab1e267c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64537f0>
          │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6453520>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64537f0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7ab1d6453520>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>>
          └ <fastapi.routing.APIRouter object at 0x7ab1d68f03a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64537f0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7ab1d6453520>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7ab1e267d7e0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64537f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6453520>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7ab1d68e95a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64537f0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7ab1d6453520>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7ab1d654ca30>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7ab1d6453760>
          └ <function wrap_app_handling_exceptions at 0x7ab1e267c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ab1d64536d0>
          │   │      └ <function RequestResponseCycle.receive at 0x7ab1d6453520>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7ab1d6453760>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7ab1d654ca30>
                     └ <function get_request_handler.<locals>.app at 0x7ab1d68e9510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7ab1e267f370>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7ab1d654e740>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7ab1d68e89d0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7ab1d68e81f0>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 69, in add_task_services
    if not await cls.check_task_unique_services(query_db, page_object):
                 │   │                          │         └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   │                          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7ab1d654e740>
                 │   └ <classmethod(<function TaskService.check_task_unique_services at 0x7ab1d68e8160>)>
                 └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 54, in check_task_unique_services
    task_uid = -1 if page_object.task_uid is None else page_object.task_uid
                     │                                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                     └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...

AttributeError: 'Redis' object has no attribute 'task_uid'
2025-04-18 15:43:28.618 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 15:43:28.619 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 15:43:28.654 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 15:43:28.655 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 15:43:28.660 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 15:43:28.660 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 15:43:31.547 | 90e5e42b8c3744b39c21508a5fe36e3f | ERROR    | exceptions.handle:exception_handler:53 - BaseModel.__init__() takes 1 positional argument but 2 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x75a6ca70f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x75a6ca856320>
           └ <SpawnProcess name='SpawnProcess-1' parent=457077 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x75a6ca855990>
    └ <SpawnProcess name='SpawnProcess-1' parent=457077 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x75a6ca713430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=457077 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=457077 started>
    │    └ <function subprocess_started at 0x75a6ca233b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=457077 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x75a6ca713550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x75a6ca232ef0>
           │       │   └ <uvicorn.server.Server object at 0x75a6ca713550>
           │       └ <function run at 0x75a6ca72e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x75a6c6097df0>
           │    └ <cyfunction Loop.run_until_complete at 0x75a6c609d700>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x75a6c8f229e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x75a6c8ffc2...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x75a6c8f...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x75a6ca713820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x75a6c8f229e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x75a6c8ffc2...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x75a6c8f...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x75a6c8ffc2...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x75a6c8f...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x75a6c8f92b30>
          └ <fastapi.applications.FastAPI object at 0x75a6ca713820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x75a6c8fbd1b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x75a6c8f...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x75a6c8f92bc0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x75a6c8f92b30>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x75a6c8fbd360>
          │    │   │      └ <function RequestResponseCycle.receive at 0x75a6c8fbd2d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x75a6c8f92bf0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x75a6c8f92bc0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x75a6c8fbd360>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x75a6c8fbd2d0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x75a6c8ffc4f0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x75a6c60beec0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x75a6c8f92bf0>
          └ <function wrap_app_handling_exceptions at 0x75a6c95e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x75a6c8fbd3f0>
          │   │      └ <function RequestResponseCycle.receive at 0x75a6c8fbd2d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x75a6c60beec0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x75a6c8fbd3f0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x75a6c8fbd2d0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x75a6c60beec0>>
          └ <fastapi.routing.APIRouter object at 0x75a6c60beec0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x75a6c8fbd3f0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x75a6c8fbd2d0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x75a6c95e79a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x75a6c8fbd3f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x75a6c8fbd2d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x75a6c6138550>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x75a6c8fbd3f0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x75a6c8fbd2d0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x75a6c8ffc640>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x75a6c8fbd480>
          └ <function wrap_app_handling_exceptions at 0x75a6c95e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x75a6c8fbd510>
          │   │      └ <function RequestResponseCycle.receive at 0x75a6c8fbd2d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x75a6c8fbd480>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x75a6c8ffc640>
                     └ <function get_request_handler.<locals>.app at 0x75a6c61384c0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x75a6c9419510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x75a6c8ffca90>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x75a6c60f3880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x75a6c60f3130>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 82, in add_task_services
    await AsyncJobUtil.add_job_to_redis(query_redis, page_object)
          │            │                │            └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.add_job_to_redis at 0x75a6c60f2c20>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 123, in add_job_to_redis
    job_param = JobSchedulerModel(task_job.model_dump())
                │                 │        └ <function BaseModel.model_dump at 0x75a6c986f130>
                │                 └ JobModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kwargs='', ...
                └ <class 'module_admin.entity.vo.task_vo.JobSchedulerModel'>

TypeError: BaseModel.__init__() takes 1 positional argument but 2 were given
2025-04-18 15:50:14.466 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 15:50:14.467 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 15:50:14.506 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 15:50:14.506 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 15:50:14.511 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 15:50:14.511 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 15:50:18.017 | 8f715750a7db450f9786e06761ff44ce | ERROR    | exceptions.handle:exception_handler:53 - BaseModel.model_dump() got an unexpected keyword argument 'extra'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x71cbbc70f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x71cbbc856320>
           └ <SpawnProcess name='SpawnProcess-1' parent=459740 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x71cbbc855990>
    └ <SpawnProcess name='SpawnProcess-1' parent=459740 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x71cbbc713430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=459740 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=459740 started>
    │    └ <function subprocess_started at 0x71cbbc233b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=459740 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x71cbbc713550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x71cbbc232ef0>
           │       │   └ <uvicorn.server.Server object at 0x71cbbc713550>
           │       └ <function run at 0x71cbbc72e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x71cbb8077df0>
           │    └ <cyfunction Loop.run_until_complete at 0x71cbb808d630>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x71cbbaf1ea40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71cbbaff83...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71cbbaf...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x71cbbc713820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x71cbbaf1ea40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71cbbaff83...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71cbbaf...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71cbbaff83...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71cbbaf...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x71cbbaf8eb90>
          └ <fastapi.applications.FastAPI object at 0x71cbbc713820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x71cbbafbd1b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71cbbaf...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x71cbbaf8ec20>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x71cbbaf8eb90>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x71cbbafbd360>
          │    │   │      └ <function RequestResponseCycle.receive at 0x71cbbafbd2d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x71cbbaf8ec50>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x71cbbaf8ec20>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x71cbbafbd360>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x71cbbafbd2d0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x71cbbaff8550>
          │                            │    └ <fastapi.routing.APIRouter object at 0x71cbb809ef20>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x71cbbaf8ec50>
          └ <function wrap_app_handling_exceptions at 0x71cbbb5e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71cbbafbd3f0>
          │   │      └ <function RequestResponseCycle.receive at 0x71cbbafbd2d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x71cbb809ef20>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71cbbafbd3f0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x71cbbafbd2d0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x71cbb809ef20>>
          └ <fastapi.routing.APIRouter object at 0x71cbb809ef20>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71cbbafbd3f0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x71cbbafbd2d0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x71cbbb5e79a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71cbbafbd3f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x71cbbafbd2d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x71cbb8118550>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71cbbafbd3f0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x71cbbafbd2d0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x71cbbaff86a0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x71cbbafbd480>
          └ <function wrap_app_handling_exceptions at 0x71cbbb5e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71cbbafbd510>
          │   │      └ <function RequestResponseCycle.receive at 0x71cbbafbd2d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x71cbbafbd480>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x71cbbaff86a0>
                     └ <function get_request_handler.<locals>.app at 0x71cbb81184c0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x71cbbb419510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x71cbbaff8af0>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x71cbb80d3880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x71cbb80d3130>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 82, in add_task_services
    await AsyncJobUtil.add_job_to_redis(query_redis, page_object)
          │            │                │            └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.add_job_to_redis at 0x71cbb80d2c20>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 123, in add_job_to_redis
    job_param = JobSchedulerModel.model_validate(task_job.model_dump(extra="allow"))
                │                 │              │        └ <function BaseModel.model_dump at 0x71cbbb86f130>
                │                 │              └ JobModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kwargs='', ...
                │                 └ <classmethod(<function BaseModel.model_validate at 0x71cbbb86f490>)>
                └ <class 'module_admin.entity.vo.task_vo.JobSchedulerModel'>

TypeError: BaseModel.model_dump() got an unexpected keyword argument 'extra'
2025-04-18 15:50:31.977 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 15:50:31.978 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 15:50:32.017 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 15:50:32.018 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 15:50:32.024 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 15:50:32.024 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 15:50:34.675 | 11e9234817794de7a648aac6dc8bf238 | ERROR    | exceptions.handle:exception_handler:53 - BaseModel.__init__() takes 1 positional argument but 2 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 16
               └ <function _main at 0x7d2fa9b0f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7d2fa9c56320>
           └ <SpawnProcess name='SpawnProcess-2' parent=459740 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7d2fa9c55990>
    └ <SpawnProcess name='SpawnProcess-2' parent=459740 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7d2fa9b13430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=459740 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=459740 started>
    │    └ <function subprocess_started at 0x7d2fa9633b50>
    └ <SpawnProcess name='SpawnProcess-2' parent=459740 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7d2fa9b13550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7d2fa9632ef0>
           │       │   └ <uvicorn.server.Server object at 0x7d2fa9b13550>
           │       └ <function run at 0x7d2fa9b2e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7d2fa5497d80>
           │    └ <cyfunction Loop.run_until_complete at 0x7d2fa54ad630>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7d2fa8322aa0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d2fa83fc3...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d2fa83...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7d2fa9b13820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7d2fa8322aa0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d2fa83fc3...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d2fa83...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d2fa83fc3...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d2fa83...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7d2fa8392bf0>
          └ <fastapi.applications.FastAPI object at 0x7d2fa9b13820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7d2fa83bd1b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d2fa83...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7d2fa8392c80>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7d2fa8392bf0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7d2fa83bd360>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7d2fa83bd2d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7d2fa8392cb0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7d2fa8392c80>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7d2fa83bd360>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7d2fa83bd2d0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7d2fa83fc5b0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7d2fa54bef80>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7d2fa8392cb0>
          └ <function wrap_app_handling_exceptions at 0x7d2fa89e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d2fa83bd3f0>
          │   │      └ <function RequestResponseCycle.receive at 0x7d2fa83bd2d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7d2fa54bef80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d2fa83bd3f0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7d2fa83bd2d0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7d2fa54bef80>>
          └ <fastapi.routing.APIRouter object at 0x7d2fa54bef80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d2fa83bd3f0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7d2fa83bd2d0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7d2fa89e79a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d2fa83bd3f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7d2fa83bd2d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7d2fa5538550>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d2fa83bd3f0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7d2fa83bd2d0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7d2fa83fc700>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7d2fa83bd480>
          └ <function wrap_app_handling_exceptions at 0x7d2fa89e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d2fa83bd510>
          │   │      └ <function RequestResponseCycle.receive at 0x7d2fa83bd2d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7d2fa83bd480>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7d2fa83fc700>
                     └ <function get_request_handler.<locals>.app at 0x7d2fa55384c0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7d2fa8819510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7d2fa83fcb50>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7d2fa54f3880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7d2fa54f3130>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 83, in add_task_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7d2fa83fcb50>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x7d2fa54f2e60>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 212, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis)
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x7d2fa54f2dd0>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 184, in execute_ready_job
    job_info = await cls.get_ready_job(query_redis)
                     │   │             └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                     │   └ <classmethod(<function AsyncJobUtil.get_ready_job at 0x7d2fa54f2d40>)>
                     └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 168, in get_ready_job
    job_param = await cls.get_job_param(query_redis, job_uid)
                      │   │             │            └ 'psi3'
                      │   │             └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                      │   └ <classmethod(<function AsyncJobUtil.get_job_param at 0x7d2fa54f2cb0>)>
                      └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 158, in get_job_param
    return JobSchedulerModel(
           └ <class 'module_admin.entity.vo.task_vo.JobSchedulerModel'>

TypeError: BaseModel.__init__() takes 1 positional argument but 2 were given
2025-04-18 15:57:50.573 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 15:57:50.574 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 15:57:50.610 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 15:57:50.610 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 15:57:50.616 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 15:57:50.616 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 15:57:53.773 | d215f5b214884c1eb9dcfa6f75ac9330 | ERROR    | exceptions.handle:exception_handler:53 - BaseModel.__init__() takes 1 positional argument but 2 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x783e0860f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x783e08756320>
           └ <SpawnProcess name='SpawnProcess-1' parent=462575 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x783e08755990>
    └ <SpawnProcess name='SpawnProcess-1' parent=462575 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x783e08613430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=462575 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=462575 started>
    │    └ <function subprocess_started at 0x783e080a3b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=462575 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x783e08613550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x783e080a2ef0>
           │       │   └ <uvicorn.server.Server object at 0x783e08613550>
           │       └ <function run at 0x783e0862e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x783dfff1fdf0>
           │    └ <cyfunction Loop.run_until_complete at 0x783dfff25700>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x783e06e2ead0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x783dff9b43...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x783dff9...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x783e08613820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x783e06e2ead0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x783dff9b43...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x783dff9...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x783dff9b43...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x783dff9...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x783e06ea2c20>
          └ <fastapi.applications.FastAPI object at 0x783e08613820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x783e06ed1240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x783dff9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x783e06ea2cb0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x783e06ea2c20>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x783e06ed13f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x783e06ed1360>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x783e06ea2ce0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x783e06ea2cb0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x783e06ed13f0>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x783e06ed1360>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x783dff9b45e0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x783dfff46fb0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x783e06ea2ce0>
          └ <function wrap_app_handling_exceptions at 0x783e074f64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x783e06ed1480>
          │   │      └ <function RequestResponseCycle.receive at 0x783e06ed1360>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x783dfff46fb0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x783e06ed1480>
          │    │                │      └ <function RequestResponseCycle.receive at 0x783e06ed1360>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x783dfff46fb0>>
          └ <fastapi.routing.APIRouter object at 0x783dfff46fb0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x783e06ed1480>
          │     │      │      └ <function RequestResponseCycle.receive at 0x783e06ed1360>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x783e074f79a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x783e06ed1480>
          │    │   │      └ <function RequestResponseCycle.receive at 0x783e06ed1360>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x783dfffc05e0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x783e06ed1480>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x783e06ed1360>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x783dff9b4730>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x783e06ed1510>
          └ <function wrap_app_handling_exceptions at 0x783e074f64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x783e06ed15a0>
          │   │      └ <function RequestResponseCycle.receive at 0x783e06ed1360>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x783e06ed1510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x783dff9b4730>
                     └ <function get_request_handler.<locals>.app at 0x783dfffc0550>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x783e07329510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x783dff9b4b80>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x783dfff7b910>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x783dfff7b1c0>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 82, in add_task_services
    await AsyncJobUtil.add_job_to_redis(query_redis, page_object)
          │            │                │            └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.add_job_to_redis at 0x783dfff7acb0>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 123, in add_job_to_redis
    job_param = JobSchedulerModel(task_job.model_dump())
                │                 │        └ <function BaseModel.model_dump at 0x783e0777f130>
                │                 └ JobModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kwargs='', ...
                └ <class 'module_admin.entity.vo.task_vo.JobSchedulerModel'>

TypeError: BaseModel.__init__() takes 1 positional argument but 2 were given
2025-04-18 15:58:19.336 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 15:58:19.338 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 15:58:19.392 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 15:58:19.393 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 15:58:19.402 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 15:58:19.402 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 15:59:17.383 | 64a9ea765c104441a15d318f420b1cd1 | ERROR    | exceptions.handle:exception_handler:53 - BaseModel.__init__() takes 1 positional argument but 2 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 14
               └ <function _main at 0x7ac32ecd5d80>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x7ac32ecb52d0>
           └ <SpawnProcess name='SpawnProcess-1' parent=462887 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7ac32ecb4940>
    └ <SpawnProcess name='SpawnProcess-1' parent=462887 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7ac32ec93790>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=462887 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=462887 started>
    │    └ <function subprocess_started at 0x7ac32c1ef2e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=462887 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7ac32ec930a0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0>]
           │       │   │    └ <function Server.serve at 0x7ac32c1b1d80>
           │       │   └ <uvicorn.server.Server object at 0x7ac32ec930a0>
           │       └ <function run at 0x7ac32c3bf130>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7ac30f887ae0>
           │    └ <cyfunction Loop.run_until_complete at 0x7ac30fa6a4d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7ac30f95b2b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ac30f6919...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ac30f6...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7ac32eca33d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7ac30f95b2b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ac30f6919...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ac30f6...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ac30f6919...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ac30f6...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7ac30f690460>
          └ <fastapi.applications.FastAPI object at 0x7ac32eca33d0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7ac30f68bc70>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7ac30f6...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7ac30f6903d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7ac30f690460>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7ac30f4f8040>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7ac30f68bf40>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7ac30f690490>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7ac30f6903d0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7ac30f4f8040>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7ac30f68bf40>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7ac30f6916f0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7ac30f8e0490>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7ac30f690490>
          └ <function wrap_app_handling_exceptions at 0x7ac31676c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ac30f4f80d0>
          │   │      └ <function RequestResponseCycle.receive at 0x7ac30f68bf40>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7ac30f8e0490>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ac30f4f80d0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7ac30f68bf40>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7ac30f8e0490>>
          └ <fastapi.routing.APIRouter object at 0x7ac30f8e0490>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ac30f4f80d0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7ac30f68bf40>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7ac31676d7e0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ac30f4f80d0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7ac30f68bf40>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7ac30f8d9750>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ac30f4f80d0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7ac30f68bf40>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7ac30f691d20>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7ac30f4f8160>
          └ <function wrap_app_handling_exceptions at 0x7ac31676c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7ac30f4f81f0>
          │   │      └ <function RequestResponseCycle.receive at 0x7ac30f68bf40>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7ac30f4f8160>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7ac30f691d20>
                     └ <function get_request_handler.<locals>.app at 0x7ac30f8d96c0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7ac31676f370>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7ac30f692170>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7ac30fb5b5b0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7ac30f8d83a0>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 82, in add_task_services
    await AsyncJobUtil.add_job_to_redis(query_redis, page_object)
          │            │                │            └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.add_job_to_redis at 0x7ac30f8b7e20>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 123, in add_job_to_redis
    job_param = JobSchedulerModel(task_job.model_dump())
                │                 │        └ <function BaseModel.model_dump at 0x7ac316b0feb0>
                │                 └ JobModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kwargs='', ...
                └ <class 'module_admin.entity.vo.task_vo.JobSchedulerModel'>

TypeError: BaseModel.__init__() takes 1 positional argument but 2 were given
2025-04-18 15:59:17.480 |  | INFO     | config.get_redis:close_redis_pool:52 - 关闭redis连接成功
2025-04-18 15:59:46.423 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 15:59:46.423 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 15:59:46.456 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 15:59:46.456 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 15:59:46.461 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 15:59:46.462 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 15:59:50.487 | e60d8cc46cbd476c9c3f18e3aa5bd037 | ERROR    | exceptions.handle:exception_handler:53 - 1 validation error for JobSchedulerModel
task_uid
  Instance is frozen [type=frozen_instance, input_value='job-alice-bob-040', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/frozen_instance
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7100af50f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7100af656320>
           └ <SpawnProcess name='SpawnProcess-1' parent=463868 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7100af655990>
    └ <SpawnProcess name='SpawnProcess-1' parent=463868 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7100af513430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=463868 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=463868 started>
    │    └ <function subprocess_started at 0x7100af033b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=463868 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7100af513550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7100af032ef0>
           │       │   └ <uvicorn.server.Server object at 0x7100af513550>
           │       └ <function run at 0x7100af52e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7100aaeaa880>
           │    └ <cyfunction Loop.run_until_complete at 0x7100aae7d700>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7100add1aaa0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7100addf03...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7100add...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7100af513820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7100add1aaa0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7100addf03...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7100add...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7100addf03...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7100add...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7100add92bf0>
          └ <fastapi.applications.FastAPI object at 0x7100af513820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7100addb9240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7100add...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7100add92c80>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7100add92bf0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7100addb93f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7100addb9360>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7100add92cb0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7100add92c80>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7100addb93f0>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7100addb9360>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7100addf05b0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7100aae9af80>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7100add92cb0>
          └ <function wrap_app_handling_exceptions at 0x7100ae3e24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7100addb9480>
          │   │      └ <function RequestResponseCycle.receive at 0x7100addb9360>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7100aae9af80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7100addb9480>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7100addb9360>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7100aae9af80>>
          └ <fastapi.routing.APIRouter object at 0x7100aae9af80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7100addb9480>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7100addb9360>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7100ae3e39a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7100addb9480>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7100addb9360>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7100aaf185e0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7100addb9480>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7100addb9360>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7100addf0700>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7100addb9510>
          └ <function wrap_app_handling_exceptions at 0x7100ae3e24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7100addb95a0>
          │   │      └ <function RequestResponseCycle.receive at 0x7100addb9360>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7100addb9510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7100addf0700>
                     └ <function get_request_handler.<locals>.app at 0x7100aaf18550>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7100ae219510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7100addf0b50>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7100aaed3910>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7100aaed31c0>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 82, in add_task_services
    await AsyncJobUtil.add_job_to_redis(query_redis, page_object)
          │            │                │            └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.add_job_to_redis at 0x7100aaed2cb0>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 124, in add_job_to_redis
    job_param.task_uid = page_object.task_uid
    │         │          │           └ 'job-alice-bob-040'
    │         │          └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
    │         └ None
    └ JobSchedulerModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/pydantic/main.py", line 1000, in __setattr__
    elif (setattr_handler := self._setattr_handler(name, value)) is not None:
          │                  │    │                │     └ 'job-alice-bob-040'
          │                  │    │                └ 'task_uid'
          │                  │    └ <function BaseModel._setattr_handler at 0x7100ae673ac0>
          │                  └ JobSchedulerModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
          └ None
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/pydantic/main.py", line 1036, in _setattr_handler
    _check_frozen(cls, name, value)
    │             │    │     └ 'job-alice-bob-040'
    │             │    └ 'task_uid'
    │             └ <class 'module_admin.entity.vo.task_vo.JobSchedulerModel'>
    └ <function _check_frozen at 0x7100ae724310>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/pydantic/main.py", line 92, in _check_frozen
    raise ValidationError.from_exception_data(
          │               └ <method 'from_exception_data' of 'pydantic_core._pydantic_core.ValidationError' objects>
          └ <class 'pydantic_core._pydantic_core.ValidationError'>

pydantic_core._pydantic_core.ValidationError: 1 validation error for JobSchedulerModel
task_uid
  Instance is frozen [type=frozen_instance, input_value='job-alice-bob-040', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/frozen_instance
2025-04-18 16:01:52.137 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 16:01:52.138 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 16:01:52.173 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 16:01:52.174 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 16:01:52.178 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 16:01:52.179 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 16:01:55.097 | 66d48534b5f0473abc23537124db3c1d | ERROR    | exceptions.handle:exception_handler:53 - BaseModel.__init__() takes 1 positional argument but 2 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7afce0f0f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7afce1056320>
           └ <SpawnProcess name='SpawnProcess-1' parent=464853 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7afce1055990>
    └ <SpawnProcess name='SpawnProcess-1' parent=464853 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7afce0f13430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=464853 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=464853 started>
    │    └ <function subprocess_started at 0x7afce0a33b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=464853 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7afce0f13550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7afce0a32ef0>
           │       │   └ <uvicorn.server.Server object at 0x7afce0f13550>
           │       └ <function run at 0x7afce0f2e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7afcdc8aa880>
           │    └ <cyfunction Loop.run_until_complete at 0x7afcdc879700>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7afcdf71aa10>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afcdf7f82...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afcdf7...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7afce0f13820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7afcdf71aa10>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afcdf7f82...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afcdf7...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afcdf7f82...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afcdf7...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7afcdf78eb60>
          └ <fastapi.applications.FastAPI object at 0x7afce0f13820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7afcdf7b91b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afcdf7...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7afcdf78ebf0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7afcdf78eb60>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7afcdf7b9360>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7afcdf7b92d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7afcdf78ec20>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7afcdf78ebf0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7afcdf7b9360>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7afcdf7b92d0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7afcdf7f8520>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7afcdc89aef0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7afcdf78ec20>
          └ <function wrap_app_handling_exceptions at 0x7afcdfde24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afcdf7b93f0>
          │   │      └ <function RequestResponseCycle.receive at 0x7afcdf7b92d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7afcdc89aef0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afcdf7b93f0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7afcdf7b92d0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7afcdc89aef0>>
          └ <fastapi.routing.APIRouter object at 0x7afcdc89aef0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afcdf7b93f0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7afcdf7b92d0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7afcdfde39a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afcdf7b93f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7afcdf7b92d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7afcdc918550>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afcdf7b93f0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7afcdf7b92d0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7afcdf7f8670>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7afcdf7b9480>
          └ <function wrap_app_handling_exceptions at 0x7afcdfde24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afcdf7b9510>
          │   │      └ <function RequestResponseCycle.receive at 0x7afcdf7b92d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7afcdf7b9480>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7afcdf7f8670>
                     └ <function get_request_handler.<locals>.app at 0x7afcdc9184c0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7afcdfc19510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7afcdf7f8ac0>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7afcdc8d3880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7afcdc8d3130>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 83, in add_task_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7afcdf7f8ac0>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x7afcdc8d2e60>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 212, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis)
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x7afcdc8d2dd0>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 184, in execute_ready_job
    job_info = await cls.get_ready_job(query_redis)
                     │   │             └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                     │   └ <classmethod(<function AsyncJobUtil.get_ready_job at 0x7afcdc8d2d40>)>
                     └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 168, in get_ready_job
    job_param = await cls.get_job_param(query_redis, job_uid)
                      │   │             │            └ 'psi3'
                      │   │             └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                      │   └ <classmethod(<function AsyncJobUtil.get_job_param at 0x7afcdc8d2cb0>)>
                      └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 158, in get_job_param
    return JobSchedulerModel(
           └ <class 'module_admin.entity.vo.task_vo.JobSchedulerModel'>

TypeError: BaseModel.__init__() takes 1 positional argument but 2 were given
2025-04-18 16:02:51.041 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 16:02:51.042 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 16:02:51.095 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 16:02:51.096 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 16:02:51.104 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 16:02:51.105 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 16:02:53.362 | c0b7b4e8139c4554ab2f624ef6fb0aa2 | ERROR    | exceptions.handle:exception_handler:53 - JobSchedulerService.add_jobs() got an unexpected keyword argument 'job_info'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 14
               └ <function _main at 0x7f17014f1d80>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x7f17014d0f70>
           └ <SpawnProcess name='SpawnProcess-1' parent=465427 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f17014d05e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=465427 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7f17014b3250>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=465427 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=465427 started>
    │    └ <function subprocess_started at 0x7f17001eb2e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=465427 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7f17014b1720>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7f17001a9d80>
           │       │   └ <uvicorn.server.Server object at 0x7f17014b1720>
           │       └ <function run at 0x7f17003bb130>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f16e581a570>
           │    └ <cyfunction Loop.run_until_complete at 0x7f16e577e5a0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f16e5866f80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f16e55a17...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f16e55...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7f17014f8ca0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f16e5866f80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f16e55a17...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f16e55...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f16e55a17...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f16e55...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f16e55a0190>
          └ <fastapi.applications.FastAPI object at 0x7f17014f8ca0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f16e5593b50>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f16e55...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7f16e55a0070>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f16e55a0190>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7f16e5593eb0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7f16e5593e20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f16e55a00d0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7f16e55a0070>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7f16e5593eb0>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7f16e5593e20>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7f16e55a0cd0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7f16e57ec190>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f16e55a00d0>
          └ <function wrap_app_handling_exceptions at 0x7f16f967c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f16e5593f40>
          │   │      └ <function RequestResponseCycle.receive at 0x7f16e5593e20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7f16e57ec190>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f16e5593f40>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7f16e5593e20>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f16e57ec190>>
          └ <fastapi.routing.APIRouter object at 0x7f16e57ec190>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f16e5593f40>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7f16e5593e20>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7f16f967d7e0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f16e5593f40>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7f16e5593e20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7f16e57e5630>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f16e5593f40>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7f16e5593e20>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7f16e55a19f0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7f16e5400040>
          └ <function wrap_app_handling_exceptions at 0x7f16f967c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f16e54000d0>
          │   │      └ <function RequestResponseCycle.receive at 0x7f16e5593e20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7f16e5400040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7f16e55a19f0>
                     └ <function get_request_handler.<locals>.app at 0x7f16e57e55a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f16f967f370>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7f16e55a1e40>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7f16e57e4a60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7f16e57e4280>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 83, in add_task_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7f16e55a1e40>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x7f16e57c3f40>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 212, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis)
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x7f16e57c3eb0>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 187, in execute_ready_job
    await JobSchedulerService.add_jobs(job_info=job_info)
          │                   │                 └ JobSchedulerModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
          │                   └ <function JobSchedulerService.add_jobs at 0x7f16e57c3b50>
          └ <class 'module_admin.service.job_service.JobSchedulerService'>

TypeError: JobSchedulerService.add_jobs() got an unexpected keyword argument 'job_info'
2025-04-18 16:25:20.396 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 16:25:20.397 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 16:25:20.431 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 16:25:20.431 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 16:25:20.436 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 16:25:20.437 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 16:25:32.611 | c4721474b6f148b68f375dc9ac31313a | ERROR    | exceptions.handle:exception_handler:53 - JobSchedulerService.add_jobs() missing 1 required positional argument: 'self'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7177971132e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x71779725a320>
           └ <SpawnProcess name='SpawnProcess-1' parent=473537 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x717797259990>
    └ <SpawnProcess name='SpawnProcess-1' parent=473537 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x717797117430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=473537 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=473537 started>
    │    └ <function subprocess_started at 0x717796ba7b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=473537 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x717797117550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x717796ba6ef0>
           │       │   └ <uvicorn.server.Server object at 0x717797117550>
           │       └ <function run at 0x7177971324d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7177929ffd10>
           │    └ <cyfunction Loop.run_until_complete at 0x717792a05700>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x71779591ea70>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7177959e43...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7177959...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x717797117820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x71779591ea70>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7177959e43...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7177959...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7177959e43...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7177959...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x717795986bc0>
          └ <fastapi.applications.FastAPI object at 0x717797117820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7177959b5240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7177959...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x717795986c50>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x717795986bc0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7177959b53f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7177959b5360>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x717795986c80>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x717795986c50>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7177959b53f0>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7177959b5360>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7177959e4580>
          │                            │    └ <fastapi.routing.APIRouter object at 0x717792a26f50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x717795986c80>
          └ <function wrap_app_handling_exceptions at 0x717795ff64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7177959b5480>
          │   │      └ <function RequestResponseCycle.receive at 0x7177959b5360>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x717792a26f50>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7177959b5480>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7177959b5360>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x717792a26f50>>
          └ <fastapi.routing.APIRouter object at 0x717792a26f50>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7177959b5480>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7177959b5360>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x717795ff79a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7177959b5480>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7177959b5360>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x717792aa05e0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7177959b5480>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7177959b5360>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7177959e46d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7177959b5510>
          └ <function wrap_app_handling_exceptions at 0x717795ff64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7177959b55a0>
          │   │      └ <function RequestResponseCycle.receive at 0x7177959b5360>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7177959b5510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7177959e46d0>
                     └ <function get_request_handler.<locals>.app at 0x717792aa0550>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x717795e29510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7177959e4b20>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x717792a5b910>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x717792a5b1c0>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 83, in add_task_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7177959e4b20>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x717792a5aef0>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 220, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis)
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x717792a5ae60>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 198, in execute_ready_job
    await JobSchedulerService.add_jobs(job_info=job_execute_list)
          │                   │                 └ [JobSchedulerModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_k...
          │                   └ <function JobSchedulerService.add_jobs at 0x717792a5aa70>
          └ <class 'module_admin.service.job_service.JobSchedulerService'>

TypeError: JobSchedulerService.add_jobs() missing 1 required positional argument: 'self'
2025-04-18 16:27:56.283 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 16:27:56.284 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 16:27:56.316 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 16:27:56.316 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 16:27:56.321 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 16:27:56.322 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 16:28:00.202 | 6acbd417f2ee453eb2cf6e626f97714c | ERROR    | exceptions.handle:exception_handler:53 - __enter__
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x72b0aa2ab2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x72b0aa436320>
           └ <SpawnProcess name='SpawnProcess-1' parent=474812 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x72b0aa435990>
    └ <SpawnProcess name='SpawnProcess-1' parent=474812 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x72b0aa2af430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=474812 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=474812 started>
    │    └ <function subprocess_started at 0x72b0a9d53b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=474812 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x72b0aa2af550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x72b0a9d52ef0>
           │       │   └ <uvicorn.server.Server object at 0x72b0aa2af550>
           │       └ <function run at 0x72b0aa2ca4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x72b0a5ba7d10>
           │    └ <cyfunction Loop.run_until_complete at 0x72b0a5bad700>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x72b0a8a4ea70>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x72b0a56243...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x72b0a56...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x72b0aa2af820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x72b0a8a4ea70>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x72b0a56243...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x72b0a56...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x72b0a56243...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x72b0a56...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x72b0a8abebc0>
          └ <fastapi.applications.FastAPI object at 0x72b0aa2af820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x72b0a8aed240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x72b0a56...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x72b0a8abec50>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x72b0a8abebc0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x72b0a8aed3f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x72b0a8aed360>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x72b0a8abec80>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x72b0a8abec50>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x72b0a8aed3f0>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x72b0a8aed360>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x72b0a5624580>
          │                            │    └ <fastapi.routing.APIRouter object at 0x72b0a5bcef50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x72b0a8abec80>
          └ <function wrap_app_handling_exceptions at 0x72b0a8f124d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x72b0a8aed480>
          │   │      └ <function RequestResponseCycle.receive at 0x72b0a8aed360>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x72b0a5bcef50>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x72b0a8aed480>
          │    │                │      └ <function RequestResponseCycle.receive at 0x72b0a8aed360>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x72b0a5bcef50>>
          └ <fastapi.routing.APIRouter object at 0x72b0a5bcef50>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x72b0a8aed480>
          │     │      │      └ <function RequestResponseCycle.receive at 0x72b0a8aed360>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x72b0a8f139a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x72b0a8aed480>
          │    │   │      └ <function RequestResponseCycle.receive at 0x72b0a8aed360>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x72b0a5c485e0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x72b0a8aed480>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x72b0a8aed360>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x72b0a56246d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x72b0a8aed510>
          └ <function wrap_app_handling_exceptions at 0x72b0a8f124d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x72b0a8aed5a0>
          │   │      └ <function RequestResponseCycle.receive at 0x72b0a8aed360>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x72b0a8aed510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x72b0a56246d0>
                     └ <function get_request_handler.<locals>.app at 0x72b0a5c48550>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x72b0a8f45510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x72b0a5624b20>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x72b0a5c03910>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x72b0a5c031c0>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 83, in add_task_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x72b0a5624b20>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x72b0a5c02ef0>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 221, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis)
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x72b0a5c02e60>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 198, in execute_ready_job
    with JobSchedulerService() as job_scheduler:
         └ <class 'module_admin.service.job_service.JobSchedulerService'>

AttributeError: __enter__
2025-04-18 16:31:41.117 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 16:31:41.117 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 16:31:41.152 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 16:31:41.153 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 16:31:41.157 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 16:31:41.158 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 16:31:47.294 | 8db3fd70a34b4b55adf63d202275e50a | INFO     | module_admin.controller.task_controller:add_task:69 - 新增成功
2025-04-18 16:33:45.086 | 1c83cf925ca5468d87587fa62a514000 | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为job-alice-bob-040的信息成功
2025-04-18 20:00:53.364 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 20:00:53.364 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 20:00:53.402 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 20:00:53.403 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 20:00:53.407 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 20:00:53.408 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 20:01:00.500 | adabd534d04848a8b1dbeefd1f9b607e | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为job-alice-bob-040的信息成功
2025-04-18 20:01:19.832 | 9216060284304ba695480aacb7b3f265 | INFO     | module_admin.controller.task_controller:query_detail_task:28 - 获取task_uid为list的信息成功
2025-04-18 20:02:12.832 | 03be921bdbea4999bfa3742582992d3f | INFO     | module_admin.controller.task_controller:get_task_list:50 - 获取成功
2025-04-18 20:03:05.559 | 77676c6487204d6aa93496d21d0d7aaa | ERROR    | exceptions.handle:exception_handler:53 - (asyncmy.errors.IntegrityError) (1062, "Duplicate entry 'job-alice-bob-040' for key 'sys_task.PRIMARY'")
[SQL: INSERT INTO sys_task (task_uid, task_name, task_initiator, task_group, task_yaml, concurrent, cron_expression, misfire_policy, status, run_status, task_progress, priority, create_by, create_time, update_by, update_time, remark) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ('job-alice-bob-040', 'task2', 'alice', 'default', '[{"job_uid": "psi3", "job_executor": "default", "invoke_target": "module_task.scheduler_test.job", "job_args": "", "job_kwargs": "", "job_name": "psi ... (162 characters truncated) ... r_test.job", "job_args": "", "job_kwargs": "", "job_name": "psi2", "job_parties": "[\\"party1\\",\\"party2\\"]", "job_dependencies": "[\\"psi3\\"]"}]', '1', '0/10 * * * * ?', '3', '1', 'not started', 0, '0', '', datetime.datetime(2025, 4, 18, 20, 3, 5, 533159), '', datetime.datetime(2025, 4, 18, 20, 3, 5, 533398), 'test')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x725f704e0040>
    │    └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x725f7026bd00>
    └ <sqlalchemy.engine.base.Connection object at 0x725f6d77a500>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('job-alice-bob-040', 'task2', 'alice', 'default', '[{"job_uid": "psi3", "job_executor": "default", "invoke_target": "module_...
    │      │       └ 'INSERT INTO sys_task (task_uid, task_name, task_initiator, task_group, task_yaml, concurrent, cron_expression, misfire_polic...
    │      └ <function AsyncAdapt_asyncmy_cursor.execute at 0x725f701180d0>
    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x725f6d7604a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 95, in execute
    return self.await_(self._execute_async(operation, parameters))
           │    │      │    │              │          └ ('job-alice-bob-040', 'task2', 'alice', 'default', '[{"job_uid": "psi3", "job_executor": "default", "invoke_target": "module_...
           │    │      │    │              └ 'INSERT INTO sys_task (task_uid, task_name, task_initiator, task_group, task_yaml, concurrent, cron_expression, misfire_polic...
           │    │      │    └ <function AsyncAdapt_asyncmy_cursor._execute_async at 0x725f701181f0>
           │    │      └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x725f6d7604a0>
           │    └ <member 'await_' of 'AsyncAdapt_asyncmy_cursor' objects>
           └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x725f6d7604a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <coroutine object AsyncAdapt_asyncmy_cursor._execute_async at 0x725f70ba7760>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x725f6e1b3cc0 (otid=0x725f70f9dfe0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <_cython_3_0_11.coroutine object at 0x725f6dd67c40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 107, in _execute_async
    result = await self._cursor.execute(operation, parameters)
                   │    │               │          └ ('job-alice-bob-040', 'task2', 'alice', 'default', '[{"job_uid": "psi3", "job_executor": "default", "invoke_target": "module_...
                   │    │               └ 'INSERT INTO sys_task (task_uid, task_name, task_initiator, task_group, task_yaml, concurrent, cron_expression, misfire_polic...
                   │    └ <member '_cursor' of 'AsyncAdapt_asyncmy_cursor' objects>
                   └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x725f6d7604a0>
  File "asyncmy/cursors.pyx", line 179, in execute
    result = await self._query(query)
  File "asyncmy/cursors.pyx", line 364, in _query
    await conn.query(q)
  File "asyncmy/connection.pyx", line 496, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "asyncmy/connection.pyx", line 684, in _read_query_result
    await result.read()
  File "asyncmy/connection.pyx", line 1071, in read
    first_packet = await self.connection.read_packet()
  File "asyncmy/connection.pyx", line 646, in read_packet
    packet.raise_for_error()
  File "asyncmy/protocol.pyx", line 190, in asyncmy.protocol.MysqlPacket.raise_for_error
    cpdef raise_for_error(self):
  File "asyncmy/protocol.pyx", line 194, in asyncmy.protocol.MysqlPacket.raise_for_error
    errors.raise_mysql_exception(self._data)
    │      └ <cyfunction raise_mysql_exception at 0x725f70387d30>
    └ <module 'asyncmy.errors' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/asyncmy/errors.c...
  File "asyncmy/errors.pyx", line 128, in asyncmy.errors.raise_mysql_exception
    cpdef raise_mysql_exception(bytes data):
          └ <cyfunction raise_mysql_exception at 0x725f70387d30>
  File "asyncmy/errors.pyx", line 137, in asyncmy.errors.raise_mysql_exception
    raise error_class(errno, err_val)

asyncmy.errors.IntegrityError: (1062, "Duplicate entry 'job-alice-bob-040' for key 'sys_task.PRIMARY'")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x725f7230f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x725f72456320>
           └ <SpawnProcess name='SpawnProcess-1' parent=545687 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x725f72455990>
    └ <SpawnProcess name='SpawnProcess-1' parent=545687 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x725f72313430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=545687 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=545687 started>
    │    └ <function subprocess_started at 0x725f71e33b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=545687 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x725f72313550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x725f71e32ef0>
           │       │   └ <uvicorn.server.Server object at 0x725f72313550>
           │       └ <function run at 0x725f7232e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x725f6dc97d10>
           │    └ <cyfunction Loop.run_until_complete at 0x725f6dc99700>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x725f70b269e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x725f70bfc5...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x725f70b...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x725f72313820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x725f70b269e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x725f70bfc5...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x725f70b...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x725f70bfc5...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x725f70b...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x725f70b92b30>
          └ <fastapi.applications.FastAPI object at 0x725f72313820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x725f70bc1630>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x725f70b...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x725f70b92bc0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x725f70b92b30>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x725f70bc1990>
          │    │   │      └ <function RequestResponseCycle.receive at 0x725f70bc1870>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x725f70b92bf0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x725f70b92bc0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x725f70bc1990>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x725f70bc1870>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x725f70bfd300>
          │                            │    └ <fastapi.routing.APIRouter object at 0x725f6dcbeec0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x725f70b92bf0>
          └ <function wrap_app_handling_exceptions at 0x725f711e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x725f70bc16c0>
          │   │      └ <function RequestResponseCycle.receive at 0x725f70bc1870>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x725f6dcbeec0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x725f70bc16c0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x725f70bc1870>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x725f6dcbeec0>>
          └ <fastapi.routing.APIRouter object at 0x725f6dcbeec0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x725f70bc16c0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x725f70bc1870>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x725f711e79a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x725f70bc16c0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x725f70bc1870>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x725f6dd38670>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x725f70bc16c0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x725f70bc1870>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x725f6d77beb0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x725f70bc1a20>
          └ <function wrap_app_handling_exceptions at 0x725f711e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x725f6d765870>
          │   │      └ <function RequestResponseCycle.receive at 0x725f70bc1870>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x725f70bc1a20>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x725f6d77beb0>
                     └ <function get_request_handler.<locals>.app at 0x725f6dd385e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x725f71019510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x725f6d778a60>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x725f6dcf39a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 66, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x725f6dcf3250>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 89, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 75, in add_task_services
    add_task = await TaskDao.add_task_dao(query_db, page_object)
                     │       │            │         └ TaskModel(task_uid='job-alice-bob-040', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
                     │       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x725f6d778a60>
                     │       └ <classmethod(<function TaskDao.add_task_dao at 0x725f6e371d80>)>
                     └ <class 'module_admin.dao.task_dao.TaskDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/task_dao.py", line 134, in add_task_dao
    await db.flush()
          │  └ <function AsyncSession.flush at 0x725f70293370>
          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x725f6d778a60>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
          │              │    │            │              └ None
          │              │    │            └ <function Session.flush at 0x725f701d1d80>
          │              │    └ <sqlalchemy.orm.session.Session object at 0x725f6d77bcd0>
          │              └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x725f6d778a60>
          └ <function greenlet_spawn at 0x725f70fdd900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             │       │      └ None
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x725f6e1b3cc0 (otid=0x725f70f9dfe0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x725f701d1f30>
    └ <sqlalchemy.orm.session.Session object at 0x725f6d77bcd0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x725f6d7b1440>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(asyncmy.errors.IntegrityError) (1062, "Duplicate entry \'job-alice-bob-040\' for key \'sys_task.PRIMARY\'")')
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x725f701c40d0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x725f70bfc070>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x725f70bfc070>
    │   └ <function SaveUpdateAll.execute at 0x725f701c49d0>
    └ SaveUpdateAll(Mapper[SysTask(sys_task)])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x725f70352e60>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqla...
    │    └ <module 'sqlalchemy.util.preloaded' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlal...
    └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x725f70353880>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x725f70630a60>
             └ <sqlalchemy.engine.base.Connection object at 0x725f6d77a500>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x725f6d7786d0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x725f70630d30>
           └ <sqlalchemy.engine.base.Connection object at 0x725f6d77a500>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x725f70630ee0>
          └ <sqlalchemy.engine.base.Connection object at 0x725f6d77a500>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x725f70630f70>
           └ <sqlalchemy.engine.base.Connection object at 0x725f6d77a500>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x725f706311b0>
    └ <sqlalchemy.engine.base.Connection object at 0x725f6d77a500>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ IntegrityError(1062, "Duplicate entry 'job-alice-bob-040' for key 'sys_task.PRIMARY'")
          │                    │              └ (<class 'asyncmy.errors.IntegrityError'>, IntegrityError(1062, "Duplicate entry 'job-alice-bob-040' for key 'sys_task.PRIMARY...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(asyncmy.errors.IntegrityError) (1062, "Duplicate entry \'job-alice-bob-040\' for key \'sys_task.PRIMARY\'")')
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x725f704e0040>
    │    └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x725f7026bd00>
    └ <sqlalchemy.engine.base.Connection object at 0x725f6d77a500>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('job-alice-bob-040', 'task2', 'alice', 'default', '[{"job_uid": "psi3", "job_executor": "default", "invoke_target": "module_...
    │      │       └ 'INSERT INTO sys_task (task_uid, task_name, task_initiator, task_group, task_yaml, concurrent, cron_expression, misfire_polic...
    │      └ <function AsyncAdapt_asyncmy_cursor.execute at 0x725f701180d0>
    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x725f6d7604a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 95, in execute
    return self.await_(self._execute_async(operation, parameters))
           │    │      │    │              │          └ ('job-alice-bob-040', 'task2', 'alice', 'default', '[{"job_uid": "psi3", "job_executor": "default", "invoke_target": "module_...
           │    │      │    │              └ 'INSERT INTO sys_task (task_uid, task_name, task_initiator, task_group, task_yaml, concurrent, cron_expression, misfire_polic...
           │    │      │    └ <function AsyncAdapt_asyncmy_cursor._execute_async at 0x725f701181f0>
           │    │      └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x725f6d7604a0>
           │    └ <member 'await_' of 'AsyncAdapt_asyncmy_cursor' objects>
           └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x725f6d7604a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <coroutine object AsyncAdapt_asyncmy_cursor._execute_async at 0x725f70ba7760>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x725f6e1b3cc0 (otid=0x725f70f9dfe0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <_cython_3_0_11.coroutine object at 0x725f6dd67c40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 107, in _execute_async
    result = await self._cursor.execute(operation, parameters)
                   │    │               │          └ ('job-alice-bob-040', 'task2', 'alice', 'default', '[{"job_uid": "psi3", "job_executor": "default", "invoke_target": "module_...
                   │    │               └ 'INSERT INTO sys_task (task_uid, task_name, task_initiator, task_group, task_yaml, concurrent, cron_expression, misfire_polic...
                   │    └ <member '_cursor' of 'AsyncAdapt_asyncmy_cursor' objects>
                   └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x725f6d7604a0>
  File "asyncmy/cursors.pyx", line 179, in execute
    result = await self._query(query)
  File "asyncmy/cursors.pyx", line 364, in _query
    await conn.query(q)
  File "asyncmy/connection.pyx", line 496, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "asyncmy/connection.pyx", line 684, in _read_query_result
    await result.read()
  File "asyncmy/connection.pyx", line 1071, in read
    first_packet = await self.connection.read_packet()
  File "asyncmy/connection.pyx", line 646, in read_packet
    packet.raise_for_error()
  File "asyncmy/protocol.pyx", line 190, in asyncmy.protocol.MysqlPacket.raise_for_error
    cpdef raise_for_error(self):
  File "asyncmy/protocol.pyx", line 194, in asyncmy.protocol.MysqlPacket.raise_for_error
    errors.raise_mysql_exception(self._data)
    │      └ <cyfunction raise_mysql_exception at 0x725f70387d30>
    └ <module 'asyncmy.errors' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/asyncmy/errors.c...
  File "asyncmy/errors.pyx", line 128, in asyncmy.errors.raise_mysql_exception
    cpdef raise_mysql_exception(bytes data):
          └ <cyfunction raise_mysql_exception at 0x725f70387d30>
  File "asyncmy/errors.pyx", line 137, in asyncmy.errors.raise_mysql_exception
    raise error_class(errno, err_val)

sqlalchemy.exc.IntegrityError: (asyncmy.errors.IntegrityError) (1062, "Duplicate entry 'job-alice-bob-040' for key 'sys_task.PRIMARY'")
[SQL: INSERT INTO sys_task (task_uid, task_name, task_initiator, task_group, task_yaml, concurrent, cron_expression, misfire_policy, status, run_status, task_progress, priority, create_by, create_time, update_by, update_time, remark) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ('job-alice-bob-040', 'task2', 'alice', 'default', '[{"job_uid": "psi3", "job_executor": "default", "invoke_target": "module_task.scheduler_test.job", "job_args": "", "job_kwargs": "", "job_name": "psi ... (162 characters truncated) ... r_test.job", "job_args": "", "job_kwargs": "", "job_name": "psi2", "job_parties": "[\\"party1\\",\\"party2\\"]", "job_dependencies": "[\\"psi3\\"]"}]', '1', '0/10 * * * * ?', '3', '1', 'not started', 0, '0', '', datetime.datetime(2025, 4, 18, 20, 3, 5, 533159), '', datetime.datetime(2025, 4, 18, 20, 3, 5, 533398), 'test')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-18 20:03:12.266 | 4910cfe64abe47be9fd18dcf5218f926 | INFO     | module_admin.controller.task_controller:add_task:69 - 新增成功
2025-04-18 20:43:51.805 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 20:43:51.805 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 20:43:51.839 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 20:43:51.839 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 20:43:51.845 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 20:43:51.845 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 20:44:30.983 | 8cdc36499fa54436900b2af5b473bbd8 | INFO     | module_admin.controller.task_controller:add_task:74 - 新增成功
2025-04-18 20:47:23.097 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 20:47:23.097 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 20:47:23.126 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 20:47:23.127 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 20:47:23.132 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 20:47:23.133 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 20:47:27.148 | 6628b7c32ea74db4b86a01af3f161b20 | ERROR    | exceptions.handle:exception_handler:53 - BaseModel.__init__() takes 1 positional argument but 2 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 16
               └ <function _main at 0x74f6cd4ab2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x74f6cd636320>
           └ <SpawnProcess name='SpawnProcess-2' parent=560739 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x74f6cd635990>
    └ <SpawnProcess name='SpawnProcess-2' parent=560739 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x74f6cd4af430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=560739 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=560739 started>
    │    └ <function subprocess_started at 0x74f6ccf53b50>
    └ <SpawnProcess name='SpawnProcess-2' parent=560739 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x74f6cd4af550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x74f6ccf52ef0>
           │       │   └ <uvicorn.server.Server object at 0x74f6cd4af550>
           │       └ <function run at 0x74f6cd4ca4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x74f6c8db3d10>
           │    └ <cyfunction Loop.run_until_complete at 0x74f6c8dbd700>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x74f6cbc41150>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x74f6cbcf90...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x74f6cbc...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x74f6cd4af820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x74f6cbc41150>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x74f6cbcf90...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x74f6cbc...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x74f6cbcf90...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x74f6cbc...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x74f6cbcbf4f0>
          └ <fastapi.applications.FastAPI object at 0x74f6cd4af820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x74f6cbcf55a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x74f6cbc...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x74f6cbcbf5b0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x74f6cbcbf4f0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x74f6cbcf5750>
          │    │   │      └ <function RequestResponseCycle.receive at 0x74f6cbcf56c0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x74f6cbcbf5e0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x74f6cbcbf5b0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x74f6cbcf5750>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x74f6cbcf56c0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x74f6cbcf92d0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x74f6c8dd2fb0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x74f6cbcbf5e0>
          └ <function wrap_app_handling_exceptions at 0x74f6cc1124d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x74f6cbcf57e0>
          │   │      └ <function RequestResponseCycle.receive at 0x74f6cbcf56c0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x74f6c8dd2fb0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x74f6cbcf57e0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x74f6cbcf56c0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x74f6c8dd2fb0>>
          └ <fastapi.routing.APIRouter object at 0x74f6c8dd2fb0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x74f6cbcf57e0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x74f6cbcf56c0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x74f6cc1139a0>
          └ APIRoute(path='/monitor/job_complated', name='job_complated', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x74f6cbcf57e0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x74f6cbcf56c0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x74f6c8e50940>
          └ APIRoute(path='/monitor/job_complated', name='job_complated', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x74f6cbcf57e0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x74f6cbcf56c0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x74f6cbcf9420>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x74f6cbcf5870>
          └ <function wrap_app_handling_exceptions at 0x74f6cc1124d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x74f6cbcf5900>
          │   │      └ <function RequestResponseCycle.receive at 0x74f6cbcf56c0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x74f6cbcf5870>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x74f6cbcf9420>
                     └ <function get_request_handler.<locals>.app at 0x74f6c8e508b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x74f6cc145510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x74f6cbcf9870>, 'job_complated': JobExecuteResponseModel...
                 │         └ <function job_complated at 0x74f6c8e03ac0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 90, in job_complated
    await AsyncJobUtil.complete_job_services(request.app.state.redis, job_complated, query_db)
          │            │                     │       │                │              └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x74f6cbcf9870>
          │            │                     │       │                └ JobExecuteResponseModel(job_uid='psi3', success=True)
          │            │                     │       └ <property object at 0x74f6cc272bb0>
          │            │                     └ <starlette.requests.Request object at 0x74f6cbcf9420>
          │            └ <classmethod(<function AsyncJobUtil.complete_job_services at 0x74f6c8e030a0>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 306, in complete_job_services
    await cls.update_task_progress(query_redis, query_db, task_uid, job_uid)
          │   │                    │            │         │         └ 'psi3'
          │   │                    │            │         └ 'job-alice-bob-042'
          │   │                    │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x74f6cbcf9870>
          │   │                    └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │   └ <classmethod(<function AsyncJobUtil.update_task_progress at 0x74f6c8e02f80>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 227, in update_task_progress
    task_progress = TaskProgressModel(
                    └ <class 'module_admin.entity.vo.task_vo.TaskProgressModel'>

TypeError: BaseModel.__init__() takes 1 positional argument but 2 were given
2025-04-18 20:47:50.985 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 20:47:50.985 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 20:47:51.016 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 20:47:51.017 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 20:47:51.021 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 20:47:51.021 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 20:50:58.577 |  | INFO     | config.get_redis:close_redis_pool:52 - 关闭redis连接成功
2025-04-18 20:50:59.488 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 20:50:59.489 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 20:50:59.518 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 20:50:59.518 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 20:50:59.524 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 20:50:59.524 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 20:51:18.378 | c4cd38ce40fc4873bbabc50d2a9645e9 | INFO     | module_admin.controller.task_controller:add_task:74 - 新增成功
2025-04-18 20:53:11.210 | 43e195294a6a4d739061d37dd69d202a | INFO     | module_admin.controller.task_controller:add_task:74 - 新增成功
2025-04-18 21:33:29.850 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 21:33:29.852 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 21:33:29.926 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 21:33:29.927 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 21:33:29.932 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 21:33:29.933 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 21:33:33.044 |  | INFO     | config.get_redis:close_redis_pool:52 - 关闭redis连接成功
2025-04-18 21:36:01.063 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 21:36:01.064 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 21:36:01.095 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 21:36:01.096 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 21:36:01.099 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 21:36:01.100 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 21:36:18.050 | 1d607376df8d4e088e116c7c002c2998 | ERROR    | exceptions.handle:exception_handler:53 - No primary key value supplied for column(s) sys_task.task_uid; per-row ORM Bulk UPDATE by Primary Key requires that records contain primary key values (Background on this error at: https://sqlalche.me/e/20/bupq)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x78635ef0f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x78635f056320>
           └ <SpawnProcess name='SpawnProcess-1' parent=582194 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x78635f055990>
    └ <SpawnProcess name='SpawnProcess-1' parent=582194 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x78635ef13430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=582194 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=582194 started>
    │    └ <function subprocess_started at 0x78635e9a3b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=582194 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x78635ef13550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x78635e9a2ef0>
           │       │   └ <uvicorn.server.Server object at 0x78635ef13550>
           │       └ <function run at 0x78635ef2e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x78635a8a3f40>
           │    └ <cyfunction Loop.run_until_complete at 0x78635a8a97d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x78635d719cc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x78635d7d1b...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x78635d7...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x78635ef13820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x78635d719cc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x78635d7d1b...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x78635d7...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x78635d7d1b...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x78635d7...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x78635d7d0520>
          └ <fastapi.applications.FastAPI object at 0x78635ef13820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x78635d7d5870>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x78635d7...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x78635d7d05b0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x78635d7d0520>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x78635d7d5a20>
          │    │   │      └ <function RequestResponseCycle.receive at 0x78635d7d5990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x78635d7d05e0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x78635d7d05b0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x78635d7d5a20>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x78635d7d5990>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x78635d7d1e10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x78635a8cb010>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x78635d7d05e0>
          └ <function wrap_app_handling_exceptions at 0x78635ddf24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x78635d7d5ab0>
          │   │      └ <function RequestResponseCycle.receive at 0x78635d7d5990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x78635a8cb010>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x78635d7d5ab0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x78635d7d5990>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x78635a8cb010>>
          └ <fastapi.routing.APIRouter object at 0x78635a8cb010>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x78635d7d5ab0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x78635d7d5990>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x78635ddf39a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x78635d7d5ab0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x78635d7d5990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x78635a948af0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x78635d7d5ab0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x78635d7d5990>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x78635d7d1f60>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x78635d7d5b40>
          └ <function wrap_app_handling_exceptions at 0x78635ddf24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x78635d7d5bd0>
          │   │      └ <function RequestResponseCycle.receive at 0x78635d7d5990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x78635d7d5b40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x78635d7d1f60>
                     └ <function get_request_handler.<locals>.app at 0x78635a948b80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x78635dc25510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x78635d7d2380>, 'task_uid': 'job-alice-bob-044', 'reques...
                 │         └ <function execute_system_task at 0x78635a8ffbe0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x78635a8ff1c0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 186, in execute_task_once_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid=None, task_name=None, task_initiator=None, task_group='default', task_yaml=[], concurrent='1', cron_expres...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x78635d7d2380>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x78635a8fee60>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 229, in execute_ready_job_reset
    await TaskDao.edit_task_dao(
          │       └ <classmethod(<function TaskDao.edit_task_dao at 0x78635af3b250>)>
          └ <class 'module_admin.dao.task_dao.TaskDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/task_dao.py", line 147, in edit_task_dao
    await db.execute(update(SysTask), [task])
          │  │       │      │          └ {'task_uid': None, 'task_name': None, 'task_initiator': None, 'task_group': 'default', 'task_yaml': [], 'concurrent': '1', 'c...
          │  │       │      └ <class 'module_admin.entity.do.task_do.SysTask'>
          │  │       └ <function update at 0x78635d529630>
          │  └ <function AsyncSession.execute at 0x78635ce9ee60>
          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x78635d7d2380>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x78635dbe9900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             │       │       │       └ {'params': [{'task_uid': None, 'task_name': None, 'task_initiator': None, 'task_group': 'default', 'task_yaml': [], 'concurre...
             │       │       └ (<sqlalchemy.sql.dml.Update object at 0x78635d7d2320>,)
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x78635d7dda40 (otid=0x78635dba9fe0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x78635cddc280>
           └ <sqlalchemy.orm.session.Session object at 0x78635d7d2440>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMUpdate.orm_execute_statement at 0x78635cfb1090>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMUpdate'>
                   └ typing.Any
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/bulk_persistence.py", line 1627, in orm_execute_statement
    result = _bulk_update(
             └ <function _bulk_update at 0x78635cf5fd90>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/bulk_persistence.py", line 357, in _bulk_update
    persistence._emit_update_statements(
    │           └ <function _emit_update_statements at 0x78635cf5f7f0>
    └ <module 'sqlalchemy.orm.persistence' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqla...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 778, in _emit_update_statements
    for (
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 560, in _collect_update_commands
    raise sa_exc.InvalidRequestError(
          │      └ <class 'sqlalchemy.exc.InvalidRequestError'>
          └ <module 'sqlalchemy.exc' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/exc.py'>

sqlalchemy.exc.InvalidRequestError: No primary key value supplied for column(s) sys_task.task_uid; per-row ORM Bulk UPDATE by Primary Key requires that records contain primary key values (Background on this error at: https://sqlalche.me/e/20/bupq)
2025-04-18 21:38:28.425 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 21:38:28.426 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 21:38:28.478 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 21:38:28.479 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 21:38:28.488 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 21:38:28.489 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 21:39:03.903 | 084505108dff49b69ccd86a29dff341e | ERROR    | exceptions.handle:exception_handler:53 - No primary key value supplied for column(s) sys_task.task_uid; per-row ORM Bulk UPDATE by Primary Key requires that records contain primary key values (Background on this error at: https://sqlalche.me/e/20/bupq)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 14
               └ <function _main at 0x7b6a48855d80>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x7b6a48835240>
           └ <SpawnProcess name='SpawnProcess-1' parent=583480 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7b6a488348b0>
    └ <SpawnProcess name='SpawnProcess-1' parent=583480 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7b6a4880e740>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=583480 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=583480 started>
    │    └ <function subprocess_started at 0x7b6a452ab2e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=583480 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7b6a4880f8b0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7b6a45265d80>
           │       │   └ <uvicorn.server.Server object at 0x7b6a4880f8b0>
           │       └ <function run at 0x7b6a45f3f130>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7b6a2d4a7c30>
           │    └ <cyfunction Loop.run_until_complete at 0x7b6a2d662670>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7b6a2d563ac0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d2a25...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d2...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7b6a488138b0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7b6a2d563ac0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d2a25...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d2...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d2a25...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d2...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7b6a2d2a1de0>
          └ <fastapi.applications.FastAPI object at 0x7b6a488138b0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7b6a2d2b81f0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d2...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7b6a2d2a1d80>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7b6a2d2a1de0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7b6a2d2b8550>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7b6a2d2b84c0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7b6a2d2a1d20>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7b6a2d2a1d80>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7b6a2d2b8550>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7b6a2d2b84c0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7b6a2d2a3340>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7b6a2d4f8610>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7b6a2d2a1d20>
          └ <function wrap_app_handling_exceptions at 0x7b6a4427c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2d2b85e0>
          │   │      └ <function RequestResponseCycle.receive at 0x7b6a2d2b84c0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7b6a2d4f8610>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2d2b85e0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7b6a2d2b84c0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7b6a2d4f8610>>
          └ <fastapi.routing.APIRouter object at 0x7b6a2d4f8610>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2d2b85e0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7b6a2d2b84c0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7b6a4427d7e0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2d2b85e0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7b6a2d2b84c0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7b6a2d4f1bd0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2d2b85e0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7b6a2d2b84c0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7b6a2d2a3550>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7b6a2d2b8670>
          └ <function wrap_app_handling_exceptions at 0x7b6a4427c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2d2b8700>
          │   │      └ <function RequestResponseCycle.receive at 0x7b6a2d2b84c0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7b6a2d2b8670>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7b6a2d2a3550>
                     └ <function get_request_handler.<locals>.app at 0x7b6a2d4f1c60>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7b6a4427f370>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b6a2d2a3970>, 'task_uid': 'job-alice-bob-044', 'reques...
                 │         └ <function execute_system_task at 0x7b6a2d4f0ca0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x7b6a2d4f0550>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 186, in execute_task_once_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid=None, task_name=None, task_initiator=None, task_group='default', task_yaml=[], concurrent='1', cron_expres...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b6a2d2a3970>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x7b6a2d4f01f0>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 229, in execute_ready_job_reset
    await TaskDao.edit_task_dao(
          │       └ <classmethod(<function TaskDao.edit_task_dao at 0x7b6a2dca8d30>)>
          └ <class 'module_admin.dao.task_dao.TaskDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/task_dao.py", line 147, in edit_task_dao
    await db.execute(update(SysTask), [task])
          │  │       │      │          └ {'task_uid': None, 'task_name': None, 'task_initiator': None, 'task_group': 'default', 'task_yaml': [], 'concurrent': '1', 'c...
          │  │       │      └ <class 'module_admin.entity.do.task_do.SysTask'>
          │  │       └ <function update at 0x7b6a2fb541f0>
          │  └ <function AsyncSession.execute at 0x7b6a2f5343a0>
          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b6a2d2a3970>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x7b6a44045900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             │       │       │       └ {'params': [{'task_uid': None, 'task_name': None, 'task_initiator': None, 'task_group': 'default', 'task_yaml': [], 'concurre...
             │       │       └ (<sqlalchemy.sql.dml.Update object at 0x7b6a2d12ca60>,)
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x7b6a487dec80 (otid=0x7b6a44003000) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x7b6a2f6201f0>
           └ <sqlalchemy.orm.session.Session object at 0x7b6a2d2a3a30>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMUpdate.orm_execute_statement at 0x7b6a2f7f0dc0>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMUpdate'>
                   └ typing.Any
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/bulk_persistence.py", line 1627, in orm_execute_statement
    result = _bulk_update(
             └ <function _bulk_update at 0x7b6a2f7bbac0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/bulk_persistence.py", line 357, in _bulk_update
    persistence._emit_update_statements(
    │           └ <function _emit_update_statements at 0x7b6a2f7bb520>
    └ <module 'sqlalchemy.orm.persistence' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqla...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 778, in _emit_update_statements
    for (
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 560, in _collect_update_commands
    raise sa_exc.InvalidRequestError(
          │      └ <class 'sqlalchemy.exc.InvalidRequestError'>
          └ <module 'sqlalchemy.exc' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/exc.py'>

sqlalchemy.exc.InvalidRequestError: No primary key value supplied for column(s) sys_task.task_uid; per-row ORM Bulk UPDATE by Primary Key requires that records contain primary key values (Background on this error at: https://sqlalche.me/e/20/bupq)
2025-04-18 21:39:39.360 | 55cb2c8020884b408437318e0a44acf3 | ERROR    | exceptions.handle:exception_handler:53 - No primary key value supplied for column(s) sys_task.task_uid; per-row ORM Bulk UPDATE by Primary Key requires that records contain primary key values (Background on this error at: https://sqlalche.me/e/20/bupq)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 14
               └ <function _main at 0x7b6a48855d80>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x7b6a48835240>
           └ <SpawnProcess name='SpawnProcess-1' parent=583480 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7b6a488348b0>
    └ <SpawnProcess name='SpawnProcess-1' parent=583480 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7b6a4880e740>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=583480 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=583480 started>
    │    └ <function subprocess_started at 0x7b6a452ab2e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=583480 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7b6a4880f8b0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7b6a45265d80>
           │       │   └ <uvicorn.server.Server object at 0x7b6a4880f8b0>
           │       └ <function run at 0x7b6a45f3f130>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7b6a2d4a7c30>
           │    └ <cyfunction Loop.run_until_complete at 0x7b6a2d662670>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7b6a2d563ac0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d12c0...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d1...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7b6a488138b0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7b6a2d563ac0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d12c0...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d1...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d12c0...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d1...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7b6a2d2a1de0>
          └ <fastapi.applications.FastAPI object at 0x7b6a488138b0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7b6a2cedb7f0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b6a2d1...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7b6a2d2a1d80>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7b6a2d2a1de0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7b6a2cedb910>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7b6a2cedb880>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7b6a2d2a1d20>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7b6a2d2a1d80>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7b6a2cedb910>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7b6a2cedb880>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7b6a2cdf6470>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7b6a2d4f8610>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7b6a2d2a1d20>
          └ <function wrap_app_handling_exceptions at 0x7b6a4427c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2cedb9a0>
          │   │      └ <function RequestResponseCycle.receive at 0x7b6a2cedb880>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7b6a2d4f8610>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2cedb9a0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7b6a2cedb880>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7b6a2d4f8610>>
          └ <fastapi.routing.APIRouter object at 0x7b6a2d4f8610>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2cedb9a0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7b6a2cedb880>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7b6a4427d7e0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2cedb9a0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7b6a2cedb880>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7b6a2d4f1bd0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2cedb9a0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7b6a2cedb880>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7b6a2cdf6260>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7b6a2cedba30>
          └ <function wrap_app_handling_exceptions at 0x7b6a4427c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b6a2cedbac0>
          │   │      └ <function RequestResponseCycle.receive at 0x7b6a2cedb880>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7b6a2cedba30>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7b6a2cdf6260>
                     └ <function get_request_handler.<locals>.app at 0x7b6a2d4f1c60>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7b6a4427f370>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b6a2cdf70a0>, 'task_uid': 'job-alice-bob-044', 'reques...
                 │         └ <function execute_system_task at 0x7b6a2d4f0ca0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x7b6a2d4f0550>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 186, in execute_task_once_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid=None, task_name=None, task_initiator=None, task_group='default', task_yaml=[], concurrent='1', cron_expres...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b6a2cdf70a0>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x7b6a2d4f01f0>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 229, in execute_ready_job_reset
    await TaskDao.edit_task_dao(
          │       └ <classmethod(<function TaskDao.edit_task_dao at 0x7b6a2dca8d30>)>
          └ <class 'module_admin.dao.task_dao.TaskDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/task_dao.py", line 147, in edit_task_dao
    await db.execute(update(SysTask), [task])
          │  │       │      │          └ {'task_uid': None, 'task_name': None, 'task_initiator': None, 'task_group': 'default', 'task_yaml': [], 'concurrent': '1', 'c...
          │  │       │      └ <class 'module_admin.entity.do.task_do.SysTask'>
          │  │       └ <function update at 0x7b6a2fb541f0>
          │  └ <function AsyncSession.execute at 0x7b6a2f5343a0>
          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b6a2cdf70a0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x7b6a44045900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             │       │       │       └ {'params': [{'task_uid': None, 'task_name': None, 'task_initiator': None, 'task_group': 'default', 'task_yaml': [], 'concurre...
             │       │       └ (<sqlalchemy.sql.dml.Update object at 0x7b6a2cdf6f50>,)
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x7b6a2d51e940 (otid=0x7b6a44003000) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x7b6a2f6201f0>
           └ <sqlalchemy.orm.session.Session object at 0x7b6a2cdf6fe0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMUpdate.orm_execute_statement at 0x7b6a2f7f0dc0>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMUpdate'>
                   └ typing.Any
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/bulk_persistence.py", line 1627, in orm_execute_statement
    result = _bulk_update(
             └ <function _bulk_update at 0x7b6a2f7bbac0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/bulk_persistence.py", line 357, in _bulk_update
    persistence._emit_update_statements(
    │           └ <function _emit_update_statements at 0x7b6a2f7bb520>
    └ <module 'sqlalchemy.orm.persistence' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqla...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 778, in _emit_update_statements
    for (
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 560, in _collect_update_commands
    raise sa_exc.InvalidRequestError(
          │      └ <class 'sqlalchemy.exc.InvalidRequestError'>
          └ <module 'sqlalchemy.exc' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/exc.py'>

sqlalchemy.exc.InvalidRequestError: No primary key value supplied for column(s) sys_task.task_uid; per-row ORM Bulk UPDATE by Primary Key requires that records contain primary key values (Background on this error at: https://sqlalche.me/e/20/bupq)
2025-04-18 21:40:23.785 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 21:40:23.786 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 21:40:23.817 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 21:40:23.818 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 21:40:23.822 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 21:40:23.823 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 21:40:28.985 | 47a7e7c2619d4e93b09b5e43983af9f2 | ERROR    | exceptions.handle:exception_handler:53 - No primary key value supplied for column(s) sys_task.task_uid; per-row ORM Bulk UPDATE by Primary Key requires that records contain primary key values (Background on this error at: https://sqlalche.me/e/20/bupq)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7d0e0db0f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7d0e0dc56320>
           └ <SpawnProcess name='SpawnProcess-1' parent=584698 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7d0e0dc55990>
    └ <SpawnProcess name='SpawnProcess-1' parent=584698 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7d0e0db13430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=584698 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=584698 started>
    │    └ <function subprocess_started at 0x7d0e0d5a3b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=584698 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7d0e0db13550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7d0e0d5a2ef0>
           │       │   └ <uvicorn.server.Server object at 0x7d0e0db13550>
           │       └ <function run at 0x7d0e0db2e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7d0e09447f40>
           │    └ <cyfunction Loop.run_until_complete at 0x7d0e0944d7d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7d0e0c319d50>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0e0c3d1c...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0e0c3...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7d0e0db13820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7d0e0c319d50>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0e0c3d1c...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0e0c3...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0e0c3d1c...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0e0c3...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7d0e0c3d0580>
          └ <fastapi.applications.FastAPI object at 0x7d0e0db13820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7d0e0c3d5870>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0e0c3...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7d0e0c3d0610>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7d0e0c3d0580>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7d0e0c3d5a20>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7d0e0c3d5990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7d0e0c3d0640>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7d0e0c3d0610>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7d0e0c3d5a20>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7d0e0c3d5990>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7d0e0c3d1ea0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7d0e0946f0a0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7d0e0c3d0640>
          └ <function wrap_app_handling_exceptions at 0x7d0e0c9f24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0e0c3d5ab0>
          │   │      └ <function RequestResponseCycle.receive at 0x7d0e0c3d5990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7d0e0946f0a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0e0c3d5ab0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7d0e0c3d5990>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7d0e0946f0a0>>
          └ <fastapi.routing.APIRouter object at 0x7d0e0946f0a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0e0c3d5ab0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7d0e0c3d5990>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7d0e0c9f39a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0e0c3d5ab0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7d0e0c3d5990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7d0e094ecaf0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0e0c3d5ab0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7d0e0c3d5990>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7d0e0c3d1ff0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7d0e0c3d5b40>
          └ <function wrap_app_handling_exceptions at 0x7d0e0c9f24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0e0c3d5bd0>
          │   │      └ <function RequestResponseCycle.receive at 0x7d0e0c3d5990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7d0e0c3d5b40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7d0e0c3d1ff0>
                     └ <function get_request_handler.<locals>.app at 0x7d0e094ecb80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7d0e0c825510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7d0e0c3d2410>, 'task_uid': 'job-alice-bob-044', 'reques...
                 │         └ <function execute_system_task at 0x7d0e094a3be0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x7d0e094a31c0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 186, in execute_task_once_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid=None, task_name=None, task_initiator=None, task_group='default', task_yaml=[], concurrent='1', cron_expres...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7d0e0c3d2410>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x7d0e094a2e60>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 229, in execute_ready_job_reset
    await TaskDao.edit_task_dao(
          │       └ <classmethod(<function TaskDao.edit_task_dao at 0x7d0e09adf250>)>
          └ <class 'module_admin.dao.task_dao.TaskDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/task_dao.py", line 147, in edit_task_dao
    await db.execute(update(SysTask), [task])
          │  │       │      │          └ {'task_uid': None, 'task_name': None, 'task_initiator': None, 'task_group': 'default', 'task_yaml': [], 'concurrent': '1', 'c...
          │  │       │      └ <class 'module_admin.entity.do.task_do.SysTask'>
          │  │       └ <function update at 0x7d0e0c129630>
          │  └ <function AsyncSession.execute at 0x7d0e0ba9ee60>
          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7d0e0c3d2410>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x7d0e0c7e9900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             │       │       │       └ {'params': [{'task_uid': None, 'task_name': None, 'task_initiator': None, 'task_group': 'default', 'task_yaml': [], 'concurre...
             │       │       └ (<sqlalchemy.sql.dml.Update object at 0x7d0e0c3d23b0>,)
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x7d0e0c3f94c0 (otid=0x7d0e0c7a9fe0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x7d0e0b9dc280>
           └ <sqlalchemy.orm.session.Session object at 0x7d0e0c3d24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMUpdate.orm_execute_statement at 0x7d0e0bbb1090>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMUpdate'>
                   └ typing.Any
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/bulk_persistence.py", line 1627, in orm_execute_statement
    result = _bulk_update(
             └ <function _bulk_update at 0x7d0e0bb5fd90>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/bulk_persistence.py", line 357, in _bulk_update
    persistence._emit_update_statements(
    │           └ <function _emit_update_statements at 0x7d0e0bb5f7f0>
    └ <module 'sqlalchemy.orm.persistence' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqla...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 778, in _emit_update_statements
    for (
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 560, in _collect_update_commands
    raise sa_exc.InvalidRequestError(
          │      └ <class 'sqlalchemy.exc.InvalidRequestError'>
          └ <module 'sqlalchemy.exc' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/exc.py'>

sqlalchemy.exc.InvalidRequestError: No primary key value supplied for column(s) sys_task.task_uid; per-row ORM Bulk UPDATE by Primary Key requires that records contain primary key values (Background on this error at: https://sqlalche.me/e/20/bupq)
2025-04-18 21:40:50.498 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 21:40:50.499 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 21:40:50.527 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 21:40:50.528 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 21:40:50.533 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 21:40:50.534 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 21:40:59.034 | a7efa072a70e43e19a01632d8e258361 | ERROR    | exceptions.handle:exception_handler:53 - AsyncJobUtil.execute_ready_job() missing 1 required positional argument: 'query_db'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x77f459acb2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x77f459c5a320>
           └ <SpawnProcess name='SpawnProcess-1' parent=585025 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x77f459c59990>
    └ <SpawnProcess name='SpawnProcess-1' parent=585025 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x77f459acf430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=585025 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=585025 started>
    │    └ <function subprocess_started at 0x77f459573b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=585025 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x77f459acf550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x77f459572ef0>
           │       │   └ <uvicorn.server.Server object at 0x77f459acf550>
           │       └ <function run at 0x77f459aea4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x77f4553c3f40>
           │    └ <cyfunction Loop.run_until_complete at 0x77f4553c97d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x77f458239d50>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x77f4582f1c...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x77f4582...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x77f459acf820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x77f458239d50>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x77f4582f1c...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x77f4582...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x77f4582f1c...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x77f4582...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x77f4582f0580>
          └ <fastapi.applications.FastAPI object at 0x77f459acf820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x77f4582f5870>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x77f4582...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x77f4582f0610>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x77f4582f0580>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x77f4582f5a20>
          │    │   │      └ <function RequestResponseCycle.receive at 0x77f4582f5990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x77f4582f0640>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x77f4582f0610>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x77f4582f5a20>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x77f4582f5990>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x77f4582f1ea0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x77f4553eb0a0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x77f4582f0640>
          └ <function wrap_app_handling_exceptions at 0x77f45870e4d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x77f4582f5ab0>
          │   │      └ <function RequestResponseCycle.receive at 0x77f4582f5990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x77f4553eb0a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x77f4582f5ab0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x77f4582f5990>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x77f4553eb0a0>>
          └ <fastapi.routing.APIRouter object at 0x77f4553eb0a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x77f4582f5ab0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x77f4582f5990>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x77f45870f9a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x77f4582f5ab0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x77f4582f5990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x77f455468af0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x77f4582f5ab0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x77f4582f5990>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x77f4582f1ff0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x77f4582f5b40>
          └ <function wrap_app_handling_exceptions at 0x77f45870e4d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x77f4582f5bd0>
          │   │      └ <function RequestResponseCycle.receive at 0x77f4582f5990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x77f4582f5b40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x77f4582f1ff0>
                     └ <function get_request_handler.<locals>.app at 0x77f455468b80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x77f45873d510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x77f4582f2410>, 'task_uid': 'job-alice-bob-044', 'reques...
                 │         └ <function execute_system_task at 0x77f45541fbe0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x77f45541f1c0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 186, in execute_task_once_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='job-alice-bob-044', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x77f4582f2410>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x77f45541ee60>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 233, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis)
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x77f45541edd0>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

TypeError: AsyncJobUtil.execute_ready_job() missing 1 required positional argument: 'query_db'
2025-04-18 21:41:53.397 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 21:41:53.399 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 21:41:53.437 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 21:41:53.437 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 21:41:53.443 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 21:41:53.443 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 21:41:56.269 | f9f0de8b3ab545dc9b31125dbfcbe9cb | ERROR    | exceptions.handle:exception_handler:53 - 'task_uid' is an invalid keyword argument for SysJobLog
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7cd4ffd0f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7cd4ffe56320>
           └ <SpawnProcess name='SpawnProcess-1' parent=585588 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7cd4ffe55990>
    └ <SpawnProcess name='SpawnProcess-1' parent=585588 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7cd4ffd13430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=585588 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=585588 started>
    │    └ <function subprocess_started at 0x7cd4ff833b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=585588 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7cd4ffd13550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7cd4ff832ef0>
           │       │   └ <uvicorn.server.Server object at 0x7cd4ffd13550>
           │       └ <function run at 0x7cd4ffd2e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7cd4f760bf40>
           │    └ <cyfunction Loop.run_until_complete at 0x7cd4f76157d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7cd4fe50dd20>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4fe5c5c...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4fe5...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7cd4ffd13820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7cd4fe50dd20>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4fe5c5c...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4fe5...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4fe5c5c...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4fe5...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7cd4fe5c4550>
          └ <fastapi.applications.FastAPI object at 0x7cd4ffd13820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7cd4fe5c9870>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4fe5...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7cd4fe5c45e0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7cd4fe5c4550>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7cd4fe5c9a20>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7cd4fe5c9990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7cd4fe5c4610>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7cd4fe5c45e0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7cd4fe5c9a20>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7cd4fe5c9990>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7cd4fe5c5e70>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7cd4f7633070>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7cd4fe5c4610>
          └ <function wrap_app_handling_exceptions at 0x7cd4febe64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4fe5c9ab0>
          │   │      └ <function RequestResponseCycle.receive at 0x7cd4fe5c9990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7cd4f7633070>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4fe5c9ab0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7cd4fe5c9990>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7cd4f7633070>>
          └ <fastapi.routing.APIRouter object at 0x7cd4f7633070>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4fe5c9ab0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7cd4fe5c9990>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7cd4febe79a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4fe5c9ab0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7cd4fe5c9990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7cd4f76b0af0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4fe5c9ab0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7cd4fe5c9990>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7cd4fe5c5fc0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7cd4fe5c9b40>
          └ <function wrap_app_handling_exceptions at 0x7cd4febe64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4fe5c9bd0>
          │   │      └ <function RequestResponseCycle.receive at 0x7cd4fe5c9990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7cd4fe5c9b40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7cd4fe5c5fc0>
                     └ <function get_request_handler.<locals>.app at 0x7cd4f76b0b80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7cd4fea19510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7cd4fe5c63e0>, 'task_uid': 'job-alice-bob-044', 'reques...
                 │         └ <function execute_system_task at 0x7cd4f7667be0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x7cd4f76671c0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 186, in execute_task_once_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='job-alice-bob-044', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7cd4fe5c63e0>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x7cd4f7666e60>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 233, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis, query_db)
                 │   │                 │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7cd4fe5c63e0>
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x7cd4f7666dd0>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 204, in execute_ready_job
    await JobLogDao.add_job_log_dao(
          │         └ <classmethod(<function JobLogDao.add_job_log_dao at 0x7cd4fc56f1c0>)>
          └ <class 'module_admin.dao.job_log_dao.JobLogDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/job_log_dao.py", line 20, in add_job_log_dao
    db_task_log = SysJobLog(**task_log.model_dump())
                  │           │        └ <function BaseModel.model_dump at 0x7cd4fee6f130>
                  │           └ JobLogModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kwargs='...
                  └ <class 'module_admin.entity.do.task_do.SysJobLog'>

  File "<string>", line 4, in __init__
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/state.py", line 571, in _initialize_instance
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x7cd4f7103680>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ TypeError("'task_uid' is an invalid keyword argument for SysJobLog")
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/state.py", line 569, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
    │       │              │            └ {'job_uid': 'psi3', 'job_executor': 'default', 'invoke_target': 'module_task.scheduler_test.job', 'job_args': '', 'job_kwargs...
    │       │              └ (<sqlalchemy.orm.state.InstanceState object at 0x7cd4fc3e7220>, <module_admin.entity.do.task_do.SysJobLog object at 0x7cd4fe5...
    │       └ <function _declarative_constructor at 0x7cd4fdbeb9a0>
    └ <ClassManager of <class 'module_admin.entity.do.task_do.SysJobLog'> at 7cd4fc3ef100>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/decl_base.py", line 2175, in _declarative_constructor
    raise TypeError(

TypeError: 'task_uid' is an invalid keyword argument for SysJobLog
2025-04-18 21:44:58.636 | fdb6f195266e4780b47bfd65da9abe61 | ERROR    | exceptions.handle:exception_handler:53 - 'task_uid' is an invalid keyword argument for SysJobLog
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7cd4ffd0f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7cd4ffe56320>
           └ <SpawnProcess name='SpawnProcess-1' parent=585588 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7cd4ffe55990>
    └ <SpawnProcess name='SpawnProcess-1' parent=585588 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7cd4ffd13430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=585588 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=585588 started>
    │    └ <function subprocess_started at 0x7cd4ff833b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=585588 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7cd4ffd13550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7cd4ff832ef0>
           │       │   └ <uvicorn.server.Server object at 0x7cd4ffd13550>
           │       └ <function run at 0x7cd4ffd2e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7cd4f760bf40>
           │    └ <cyfunction Loop.run_until_complete at 0x7cd4f76157d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7cd4fe50dd20>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4f70efd...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4f70...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7cd4ffd13820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7cd4fe50dd20>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4f70efd...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4f70...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4f70efd...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4f70...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7cd4fe5c4550>
          └ <fastapi.applications.FastAPI object at 0x7cd4ffd13820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7cd4fe5c9f30>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7cd4f70...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7cd4fe5c45e0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7cd4fe5c4550>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7cd4f7055b40>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7cd4f7055a20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7cd4fe5c4610>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7cd4fe5c45e0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7cd4f7055b40>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7cd4f7055a20>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7cd4f70effd0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7cd4f7633070>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7cd4fe5c4610>
          └ <function wrap_app_handling_exceptions at 0x7cd4febe64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4f7055ab0>
          │   │      └ <function RequestResponseCycle.receive at 0x7cd4f7055a20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7cd4f7633070>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4f7055ab0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7cd4f7055a20>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7cd4f7633070>>
          └ <fastapi.routing.APIRouter object at 0x7cd4f7633070>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4f7055ab0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7cd4f7055a20>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7cd4febe79a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4f7055ab0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7cd4f7055a20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7cd4f76b0af0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4f7055ab0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7cd4f7055a20>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7cd4f70efb50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7cd4f7055bd0>
          └ <function wrap_app_handling_exceptions at 0x7cd4febe64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7cd4f7055c60>
          │   │      └ <function RequestResponseCycle.receive at 0x7cd4f7055a20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7cd4f7055bd0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7cd4f70efb50>
                     └ <function get_request_handler.<locals>.app at 0x7cd4f76b0b80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7cd4fea19510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7cd4f70ef430>, 'task_uid': 'task_no_dependencies', 'req...
                 │         └ <function execute_system_task at 0x7cd4f7667be0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x7cd4f76671c0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 186, in execute_task_once_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='task_no_dependencies', task_name='系统默认（无依赖）', task_initiator='alice', task_group='default', task_yaml=[Jo...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7cd4f70ef430>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x7cd4f7666e60>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 233, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis, query_db)
                 │   │                 │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7cd4f70ef430>
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x7cd4f7666dd0>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 204, in execute_ready_job
    await JobLogDao.add_job_log_dao(
          │         └ <classmethod(<function JobLogDao.add_job_log_dao at 0x7cd4fc56f1c0>)>
          └ <class 'module_admin.dao.job_log_dao.JobLogDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/job_log_dao.py", line 20, in add_job_log_dao
    db_task_log = SysJobLog(**task_log.model_dump())
                  │           │        └ <function BaseModel.model_dump at 0x7cd4fee6f130>
                  │           └ JobLogModel(job_uid='psi1', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kwargs='...
                  └ <class 'module_admin.entity.do.task_do.SysJobLog'>

  File "<string>", line 4, in __init__
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/state.py", line 571, in _initialize_instance
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x7cd4fe5ce2c0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ TypeError("'task_uid' is an invalid keyword argument for SysJobLog")
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/state.py", line 569, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
    │       │              │            └ {'job_uid': 'psi1', 'job_executor': 'default', 'invoke_target': 'module_task.scheduler_test.job', 'job_args': '', 'job_kwargs...
    │       │              └ (<sqlalchemy.orm.state.InstanceState object at 0x7cd4f6fdafe0>, <module_admin.entity.do.task_do.SysJobLog object at 0x7cd4f70...
    │       └ <function _declarative_constructor at 0x7cd4fdbeb9a0>
    └ <ClassManager of <class 'module_admin.entity.do.task_do.SysJobLog'> at 7cd4fc3ef100>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/decl_base.py", line 2175, in _declarative_constructor
    raise TypeError(

TypeError: 'task_uid' is an invalid keyword argument for SysJobLog
2025-04-18 21:45:31.204 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 21:45:31.204 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 21:45:31.241 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 21:45:31.242 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 21:45:31.247 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 21:45:31.247 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 21:45:36.936 | 80b58c530b084d55b3c6a6abe08a4b0c | ERROR    | exceptions.handle:exception_handler:53 - object SysJobLog can't be used in 'await' expression
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x79358570f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x793585856320>
           └ <SpawnProcess name='SpawnProcess-1' parent=587050 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x793585855990>
    └ <SpawnProcess name='SpawnProcess-1' parent=587050 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x793585713430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=587050 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=587050 started>
    │    └ <function subprocess_started at 0x793585233b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=587050 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x793585713550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x793585232ef0>
           │       │   └ <uvicorn.server.Server object at 0x793585713550>
           │       └ <function run at 0x79358572e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7935810ae9d0>
           │    └ <cyfunction Loop.run_until_complete at 0x79358107d7d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x793583f0dde0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x793583fbdc...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x793583f...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x793585713820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x793583f0dde0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x793583fbdc...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x793583f...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x793583fbdc...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x793583f...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x793583fbc5e0>
          └ <fastapi.applications.FastAPI object at 0x793585713820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x793583fc1870>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x793583f...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x793583fbc670>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x793583fbc5e0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x793583fc1a20>
          │    │   │      └ <function RequestResponseCycle.receive at 0x793583fc1990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x793583fbc6a0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x793583fbc670>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x793583fc1a20>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x793583fc1990>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x793583fbdf30>
          │                            │    └ <fastapi.routing.APIRouter object at 0x79358109f130>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x793583fbc6a0>
          └ <function wrap_app_handling_exceptions at 0x7935845e24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x793583fc1ab0>
          │   │      └ <function RequestResponseCycle.receive at 0x793583fc1990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x79358109f130>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x793583fc1ab0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x793583fc1990>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x79358109f130>>
          └ <fastapi.routing.APIRouter object at 0x79358109f130>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x793583fc1ab0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x793583fc1990>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7935845e39a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x793583fc1ab0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x793583fc1990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x793581120af0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x793583fc1ab0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x793583fc1990>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x793583fbe080>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x793583fc1b40>
          └ <function wrap_app_handling_exceptions at 0x7935845e24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x793583fc1bd0>
          │   │      └ <function RequestResponseCycle.receive at 0x793583fc1990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x793583fc1b40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x793583fbe080>
                     └ <function get_request_handler.<locals>.app at 0x793581120b80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x793584419510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x793583fbe4a0>, 'task_uid': 'task_no_dependencies', 'req...
                 │         └ <function execute_system_task at 0x7935810d3be0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x7935810d31c0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 186, in execute_task_once_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='task_no_dependencies', task_name='系统默认（无依赖）', task_initiator='alice', task_group='default', task_yaml=[Jo...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x793583fbe4a0>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x7935810d2e60>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 233, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis, query_db)
                 │   │                 │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x793583fbe4a0>
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x7935810d2dd0>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 204, in execute_ready_job
    await JobLogDao.add_job_log_dao(
          │         └ <classmethod(<function JobLogDao.add_job_log_dao at 0x79358170f1c0>)>
          └ <class 'module_admin.dao.job_log_dao.JobLogDao'>

TypeError: object SysJobLog can't be used in 'await' expression
2025-04-18 21:47:37.505 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-18 21:47:37.505 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-18 21:47:37.542 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-18 21:47:37.543 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-18 21:47:37.546 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-18 21:47:37.546 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-18 21:47:42.457 | 31b8c76f64cf432fb46493f02b206a3e | ERROR    | exceptions.handle:exception_handler:53 - (asyncmy.errors.IntegrityError) (1048, "Column 'job_name' cannot be null")
[SQL: INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, job_kwargs, job_message, status, exception_info, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ('psi1', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', None)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x76284dee0040>
    │    └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x76284dc6fd00>
    └ <sqlalchemy.engine.base.Connection object at 0x76284e5c2770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('psi1', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
    │      │       └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
    │      └ <function AsyncAdapt_asyncmy_cursor.execute at 0x76284db1c0d0>
    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7628471186d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 95, in execute
    return self.await_(self._execute_async(operation, parameters))
           │    │      │    │              │          └ ('psi1', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
           │    │      │    │              └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
           │    │      │    └ <function AsyncAdapt_asyncmy_cursor._execute_async at 0x76284db1c1f0>
           │    │      └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7628471186d0>
           │    └ <member 'await_' of 'AsyncAdapt_asyncmy_cursor' objects>
           └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7628471186d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <coroutine object AsyncAdapt_asyncmy_cursor._execute_async at 0x76284e5cdaf0>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x7628470be200 (otid=0x76284e99dfe0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <_cython_3_0_11.coroutine object at 0x762847158040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 107, in _execute_async
    result = await self._cursor.execute(operation, parameters)
                   │    │               │          └ ('psi1', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
                   │    │               └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
                   │    └ <member '_cursor' of 'AsyncAdapt_asyncmy_cursor' objects>
                   └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7628471186d0>
  File "asyncmy/cursors.pyx", line 179, in execute
    result = await self._query(query)
  File "asyncmy/cursors.pyx", line 364, in _query
    await conn.query(q)
  File "asyncmy/connection.pyx", line 496, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "asyncmy/connection.pyx", line 684, in _read_query_result
    await result.read()
  File "asyncmy/connection.pyx", line 1071, in read
    first_packet = await self.connection.read_packet()
  File "asyncmy/connection.pyx", line 646, in read_packet
    packet.raise_for_error()
  File "asyncmy/protocol.pyx", line 190, in asyncmy.protocol.MysqlPacket.raise_for_error
    cpdef raise_for_error(self):
  File "asyncmy/protocol.pyx", line 194, in asyncmy.protocol.MysqlPacket.raise_for_error
    errors.raise_mysql_exception(self._data)
    │      └ <cyfunction raise_mysql_exception at 0x76284dd87d30>
    └ <module 'asyncmy.errors' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/asyncmy/errors.c...
  File "asyncmy/errors.pyx", line 128, in asyncmy.errors.raise_mysql_exception
    cpdef raise_mysql_exception(bytes data):
          └ <cyfunction raise_mysql_exception at 0x76284dd87d30>
  File "asyncmy/errors.pyx", line 137, in asyncmy.errors.raise_mysql_exception
    raise error_class(errno, err_val)

asyncmy.errors.IntegrityError: (1048, "Column 'job_name' cannot be null")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x76284fd0f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x76284fe56320>
           └ <SpawnProcess name='SpawnProcess-1' parent=587998 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x76284fe55990>
    └ <SpawnProcess name='SpawnProcess-1' parent=587998 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x76284fd13430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=587998 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=587998 started>
    │    └ <function subprocess_started at 0x76284f833b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=587998 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x76284fd13550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x76284f832ef0>
           │       │   └ <uvicorn.server.Server object at 0x76284fd13550>
           │       └ <function run at 0x76284fd2e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7628476469d0>
           │    └ <cyfunction Loop.run_until_complete at 0x7628476117d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x76284e511db0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x76284e5c1c...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x76284e5...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x76284fd13820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x76284e511db0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x76284e5c1c...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x76284e5...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x76284e5c1c...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x76284e5...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x76284e5c05b0>
          └ <fastapi.applications.FastAPI object at 0x76284fd13820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x76284e5c5870>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x76284e5...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x76284e5c0640>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x76284e5c05b0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x76284e5c5a20>
          │    │   │      └ <function RequestResponseCycle.receive at 0x76284e5c5990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x76284e5c0670>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x76284e5c0640>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x76284e5c5a20>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x76284e5c5990>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x76284e5c1f00>
          │                            │    └ <fastapi.routing.APIRouter object at 0x762847633100>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x76284e5c0670>
          └ <function wrap_app_handling_exceptions at 0x76284ebe24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x76284e5c5ab0>
          │   │      └ <function RequestResponseCycle.receive at 0x76284e5c5990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x762847633100>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x76284e5c5ab0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x76284e5c5990>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x762847633100>>
          └ <fastapi.routing.APIRouter object at 0x762847633100>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x76284e5c5ab0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x76284e5c5990>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x76284ebe39a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x76284e5c5ab0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x76284e5c5990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7628476b4af0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x76284e5c5ab0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x76284e5c5990>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x76284e5c2050>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x76284e5c5b40>
          └ <function wrap_app_handling_exceptions at 0x76284ebe24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x76284e5c5bd0>
          │   │      └ <function RequestResponseCycle.receive at 0x76284e5c5990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x76284e5c5b40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x76284e5c2050>
                     └ <function get_request_handler.<locals>.app at 0x7628476b4b80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x76284ea19510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x76284e5c2470>, 'task_uid': 'task_no_dependencies', 'req...
                 │         └ <function execute_system_task at 0x76284766bbe0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x76284766b1c0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 186, in execute_task_once_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='task_no_dependencies', task_name='系统默认（无依赖）', task_initiator='alice', task_group='default', task_yaml=[Jo...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x76284e5c2470>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x76284766ae60>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 233, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis, query_db)
                 │   │                 │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x76284e5c2470>
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x76284766add0>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 204, in execute_ready_job
    await JobLogDao.add_job_log_dao(
          │         └ <classmethod(<function JobLogDao.add_job_log_dao at 0x76284c56f1c0>)>
          └ <class 'module_admin.dao.job_log_dao.JobLogDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/job_log_dao.py", line 22, in add_job_log_dao
    await db.flush()
          │  └ <function AsyncSession.flush at 0x76284dc93370>
          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x76284e5c2470>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
          │              │    │            │              └ None
          │              │    │            └ <function Session.flush at 0x76284dbcdd80>
          │              │    └ <sqlalchemy.orm.session.Session object at 0x76284e5c2530>
          │              └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x76284e5c2470>
          └ <function greenlet_spawn at 0x76284e9dd900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             │       │      └ None
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x7628470be200 (otid=0x76284e99dfe0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x76284dbcdf30>
    └ <sqlalchemy.orm.session.Session object at 0x76284e5c2530>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x762847139800>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(asyncmy.errors.IntegrityError) (1048, "Column \'job_name\' cannot be null")')
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x76284dbc00d0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x76284e5c2410>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x76284e5c2410>
    │   └ <function SaveUpdateAll.execute at 0x76284dbc09d0>
    └ SaveUpdateAll(Mapper[SysJobLog(sys_job_log)])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x76284dd52e60>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqla...
    │    └ <module 'sqlalchemy.util.preloaded' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlal...
    └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x76284dd53880>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x76284e02ca60>
             └ <sqlalchemy.engine.base.Connection object at 0x76284e5c2770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x7628470f7070>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x76284e02cd30>
           └ <sqlalchemy.engine.base.Connection object at 0x76284e5c2770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x76284e02cee0>
          └ <sqlalchemy.engine.base.Connection object at 0x76284e5c2770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x76284e02cf70>
           └ <sqlalchemy.engine.base.Connection object at 0x76284e5c2770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x76284e02d1b0>
    └ <sqlalchemy.engine.base.Connection object at 0x76284e5c2770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ IntegrityError(1048, "Column 'job_name' cannot be null")
          │                    │              └ (<class 'asyncmy.errors.IntegrityError'>, IntegrityError(1048, "Column 'job_name' cannot be null"), <traceback object at 0x76...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(asyncmy.errors.IntegrityError) (1048, "Column \'job_name\' cannot be null")')
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x76284dee0040>
    │    └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x76284dc6fd00>
    └ <sqlalchemy.engine.base.Connection object at 0x76284e5c2770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('psi1', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
    │      │       └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
    │      └ <function AsyncAdapt_asyncmy_cursor.execute at 0x76284db1c0d0>
    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7628471186d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 95, in execute
    return self.await_(self._execute_async(operation, parameters))
           │    │      │    │              │          └ ('psi1', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
           │    │      │    │              └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
           │    │      │    └ <function AsyncAdapt_asyncmy_cursor._execute_async at 0x76284db1c1f0>
           │    │      └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7628471186d0>
           │    └ <member 'await_' of 'AsyncAdapt_asyncmy_cursor' objects>
           └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7628471186d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <coroutine object AsyncAdapt_asyncmy_cursor._execute_async at 0x76284e5cdaf0>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x7628470be200 (otid=0x76284e99dfe0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <_cython_3_0_11.coroutine object at 0x762847158040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 107, in _execute_async
    result = await self._cursor.execute(operation, parameters)
                   │    │               │          └ ('psi1', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
                   │    │               └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
                   │    └ <member '_cursor' of 'AsyncAdapt_asyncmy_cursor' objects>
                   └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7628471186d0>
  File "asyncmy/cursors.pyx", line 179, in execute
    result = await self._query(query)
  File "asyncmy/cursors.pyx", line 364, in _query
    await conn.query(q)
  File "asyncmy/connection.pyx", line 496, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "asyncmy/connection.pyx", line 684, in _read_query_result
    await result.read()
  File "asyncmy/connection.pyx", line 1071, in read
    first_packet = await self.connection.read_packet()
  File "asyncmy/connection.pyx", line 646, in read_packet
    packet.raise_for_error()
  File "asyncmy/protocol.pyx", line 190, in asyncmy.protocol.MysqlPacket.raise_for_error
    cpdef raise_for_error(self):
  File "asyncmy/protocol.pyx", line 194, in asyncmy.protocol.MysqlPacket.raise_for_error
    errors.raise_mysql_exception(self._data)
    │      └ <cyfunction raise_mysql_exception at 0x76284dd87d30>
    └ <module 'asyncmy.errors' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/asyncmy/errors.c...
  File "asyncmy/errors.pyx", line 128, in asyncmy.errors.raise_mysql_exception
    cpdef raise_mysql_exception(bytes data):
          └ <cyfunction raise_mysql_exception at 0x76284dd87d30>
  File "asyncmy/errors.pyx", line 137, in asyncmy.errors.raise_mysql_exception
    raise error_class(errno, err_val)

sqlalchemy.exc.IntegrityError: (asyncmy.errors.IntegrityError) (1048, "Column 'job_name' cannot be null")
[SQL: INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, job_kwargs, job_message, status, exception_info, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ('psi1', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', None)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
