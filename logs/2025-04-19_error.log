2025-04-19 15:19:07.096 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 15:19:07.097 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 15:19:07.134 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 15:19:07.135 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 15:19:07.140 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 15:19:07.140 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 15:19:41.402 | e4272baa547042b0bdfcbf7835e3b2e2 | ERROR    | exceptions.handle:exception_handler:53 - (asyncmy.errors.IntegrityError) (1048, "Column 'job_name' cannot be null")
[SQL: INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, job_kwargs, job_message, status, exception_info, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ('psi2', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', None)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7b9db17e0040>
    │    └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x7b9db156bcd0>
    └ <sqlalchemy.engine.base.Connection object at 0x7b9db1eae770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('psi2', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
    │      │       └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
    │      └ <function AsyncAdapt_asyncmy_cursor.execute at 0x7b9db14180d0>
    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7b9dae9b3f60>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 95, in execute
    return self.await_(self._execute_async(operation, parameters))
           │    │      │    │              │          └ ('psi2', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
           │    │      │    │              └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
           │    │      │    └ <function AsyncAdapt_asyncmy_cursor._execute_async at 0x7b9db14181f0>
           │    │      └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7b9dae9b3f60>
           │    └ <member 'await_' of 'AsyncAdapt_asyncmy_cursor' objects>
           └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7b9dae9b3f60>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <coroutine object AsyncAdapt_asyncmy_cursor._execute_async at 0x7b9db1e87060>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x7b9daef80740 (otid=0x7b9db1f9dfb0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <_cython_3_0_11.coroutine object at 0x7b9daea24040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 107, in _execute_async
    result = await self._cursor.execute(operation, parameters)
                   │    │               │          └ ('psi2', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
                   │    │               └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
                   │    └ <member '_cursor' of 'AsyncAdapt_asyncmy_cursor' objects>
                   └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7b9dae9b3f60>
  File "asyncmy/cursors.pyx", line 179, in execute
    result = await self._query(query)
  File "asyncmy/cursors.pyx", line 364, in _query
    await conn.query(q)
  File "asyncmy/connection.pyx", line 496, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "asyncmy/connection.pyx", line 684, in _read_query_result
    await result.read()
  File "asyncmy/connection.pyx", line 1071, in read
    first_packet = await self.connection.read_packet()
  File "asyncmy/connection.pyx", line 646, in read_packet
    packet.raise_for_error()
  File "asyncmy/protocol.pyx", line 190, in asyncmy.protocol.MysqlPacket.raise_for_error
    cpdef raise_for_error(self):
  File "asyncmy/protocol.pyx", line 194, in asyncmy.protocol.MysqlPacket.raise_for_error
    errors.raise_mysql_exception(self._data)
    │      └ <cyfunction raise_mysql_exception at 0x7b9db1687d30>
    └ <module 'asyncmy.errors' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/asyncmy/errors.c...
  File "asyncmy/errors.pyx", line 128, in asyncmy.errors.raise_mysql_exception
    cpdef raise_mysql_exception(bytes data):
          └ <cyfunction raise_mysql_exception at 0x7b9db1687d30>
  File "asyncmy/errors.pyx", line 137, in asyncmy.errors.raise_mysql_exception
    raise error_class(errno, err_val)

asyncmy.errors.IntegrityError: (1048, "Column 'job_name' cannot be null")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7b9db350f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7b9db3656320>
           └ <SpawnProcess name='SpawnProcess-1' parent=937967 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7b9db3655990>
    └ <SpawnProcess name='SpawnProcess-1' parent=937967 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7b9db3513400>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=937967 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=937967 started>
    │    └ <function subprocess_started at 0x7b9db3033b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=937967 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7b9db3513520>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7b9db3032ef0>
           │       │   └ <uvicorn.server.Server object at 0x7b9db3513520>
           │       └ <function run at 0x7b9db352e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7b9daf0f3f40>
           │    └ <cyfunction Loop.run_until_complete at 0x7b9daef017d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7b9daeff1db0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9db1eadc...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9db1e...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7b9db35137f0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7b9daeff1db0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9db1eadc...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9db1e...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9db1eadc...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9db1e...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7b9db1eac5b0>
          └ <fastapi.applications.FastAPI object at 0x7b9db35137f0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7b9db1eb1870>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9db1e...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7b9db1eac640>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7b9db1eac5b0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7b9db1eb1a20>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7b9db1eb1990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7b9db1eac670>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7b9db1eac640>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7b9db1eb1a20>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7b9db1eb1990>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7b9db1eadf00>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7b9daef1f100>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7b9db1eac670>
          └ <function wrap_app_handling_exceptions at 0x7b9db24e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9db1eb1ab0>
          │   │      └ <function RequestResponseCycle.receive at 0x7b9db1eb1990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7b9daef1f100>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9db1eb1ab0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7b9db1eb1990>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7b9daef1f100>>
          └ <fastapi.routing.APIRouter object at 0x7b9daef1f100>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9db1eb1ab0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7b9db1eb1990>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7b9db24e79a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9db1eb1ab0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7b9db1eb1990>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7b9daef9caf0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9db1eb1ab0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7b9db1eb1990>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7b9db1eae050>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7b9db1eb1b40>
          └ <function wrap_app_handling_exceptions at 0x7b9db24e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9db1eb1bd0>
          │   │      └ <function RequestResponseCycle.receive at 0x7b9db1eb1990>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7b9db1eb1b40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7b9db1eae050>
                     └ <function get_request_handler.<locals>.app at 0x7b9daef9cb80>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7b9db2319510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b9db1eae470>, 'task_uid': 'task_no_dependencies', 'req...
                 │         └ <function execute_system_task at 0x7b9daef53be0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x7b9daef531c0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 186, in execute_task_once_services
    await AsyncJobUtil.execute_ready_job_reset(query_redis, query_db, task_info)
          │            │                       │            │         └ TaskModel(task_uid='task_no_dependencies', task_name='系统默认（无依赖）', task_initiator='alice', task_group='default', task_yaml=[Jo...
          │            │                       │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b9db1eae470>
          │            │                       └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
          │            └ <classmethod(<function AsyncJobUtil.execute_ready_job_reset at 0x7b9daef52e60>)>
          └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 233, in execute_ready_job_reset
    return await cls.execute_ready_job(query_redis, query_db)
                 │   │                 │            └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b9db1eae470>
                 │   │                 └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...
                 │   └ <classmethod(<function AsyncJobUtil.execute_ready_job at 0x7b9daef52dd0>)>
                 └ <class 'module_admin.service.job_service.AsyncJobUtil'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 204, in execute_ready_job
    await JobLogDao.add_job_log_dao(
          │         └ <classmethod(<function JobLogDao.add_job_log_dao at 0x7b9daf5a31c0>)>
          └ <class 'module_admin.dao.job_log_dao.JobLogDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/job_log_dao.py", line 22, in add_job_log_dao
    await db.flush()
          │  └ <function AsyncSession.flush at 0x7b9db1593370>
          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b9db1eae470>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
          │              │    │            │              └ None
          │              │    │            └ <function Session.flush at 0x7b9db14d1d80>
          │              │    └ <sqlalchemy.orm.session.Session object at 0x7b9db1eae530>
          │              └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b9db1eae470>
          └ <function greenlet_spawn at 0x7b9db1fdd900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             │       │      └ None
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x7b9daef80740 (otid=0x7b9db1f9dfb0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7b9db14d1f30>
    └ <sqlalchemy.orm.session.Session object at 0x7b9db1eae530>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x7b9daea01680>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(asyncmy.errors.IntegrityError) (1048, "Column \'job_name\' cannot be null")')
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7b9db14c40d0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7b9db1eae410>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7b9db1eae410>
    │   └ <function SaveUpdateAll.execute at 0x7b9db14c49d0>
    └ SaveUpdateAll(Mapper[SysJobLog(sys_job_log)])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x7b9db1652e60>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqla...
    │    └ <module 'sqlalchemy.util.preloaded' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlal...
    └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x7b9db1653880>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x7b9db1930a60>
             └ <sqlalchemy.engine.base.Connection object at 0x7b9db1eae770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x7b9dae9c3070>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7b9db1930d30>
           └ <sqlalchemy.engine.base.Connection object at 0x7b9db1eae770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7b9db1930ee0>
          └ <sqlalchemy.engine.base.Connection object at 0x7b9db1eae770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x7b9db1930f70>
           └ <sqlalchemy.engine.base.Connection object at 0x7b9db1eae770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7b9db19311b0>
    └ <sqlalchemy.engine.base.Connection object at 0x7b9db1eae770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ IntegrityError(1048, "Column 'job_name' cannot be null")
          │                    │              └ (<class 'asyncmy.errors.IntegrityError'>, IntegrityError(1048, "Column 'job_name' cannot be null"), <traceback object at 0x7b...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(asyncmy.errors.IntegrityError) (1048, "Column \'job_name\' cannot be null")')
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7b9db17e0040>
    │    └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x7b9db156bcd0>
    └ <sqlalchemy.engine.base.Connection object at 0x7b9db1eae770>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('psi2', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
    │      │       └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
    │      └ <function AsyncAdapt_asyncmy_cursor.execute at 0x7b9db14180d0>
    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7b9dae9b3f60>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 95, in execute
    return self.await_(self._execute_async(operation, parameters))
           │    │      │    │              │          └ ('psi2', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
           │    │      │    │              └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
           │    │      │    └ <function AsyncAdapt_asyncmy_cursor._execute_async at 0x7b9db14181f0>
           │    │      └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7b9dae9b3f60>
           │    └ <member 'await_' of 'AsyncAdapt_asyncmy_cursor' objects>
           └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7b9dae9b3f60>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <coroutine object AsyncAdapt_asyncmy_cursor._execute_async at 0x7b9db1e87060>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x7b9daef80740 (otid=0x7b9db1f9dfb0) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <_cython_3_0_11.coroutine object at 0x7b9daea24040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 107, in _execute_async
    result = await self._cursor.execute(operation, parameters)
                   │    │               │          └ ('psi2', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', ...
                   │    │               └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
                   │    └ <member '_cursor' of 'AsyncAdapt_asyncmy_cursor' objects>
                   └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x7b9dae9b3f60>
  File "asyncmy/cursors.pyx", line 179, in execute
    result = await self._query(query)
  File "asyncmy/cursors.pyx", line 364, in _query
    await conn.query(q)
  File "asyncmy/connection.pyx", line 496, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "asyncmy/connection.pyx", line 684, in _read_query_result
    await result.read()
  File "asyncmy/connection.pyx", line 1071, in read
    first_packet = await self.connection.read_packet()
  File "asyncmy/connection.pyx", line 646, in read_packet
    packet.raise_for_error()
  File "asyncmy/protocol.pyx", line 190, in asyncmy.protocol.MysqlPacket.raise_for_error
    cpdef raise_for_error(self):
  File "asyncmy/protocol.pyx", line 194, in asyncmy.protocol.MysqlPacket.raise_for_error
    errors.raise_mysql_exception(self._data)
    │      └ <cyfunction raise_mysql_exception at 0x7b9db1687d30>
    └ <module 'asyncmy.errors' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/asyncmy/errors.c...
  File "asyncmy/errors.pyx", line 128, in asyncmy.errors.raise_mysql_exception
    cpdef raise_mysql_exception(bytes data):
          └ <cyfunction raise_mysql_exception at 0x7b9db1687d30>
  File "asyncmy/errors.pyx", line 137, in asyncmy.errors.raise_mysql_exception
    raise error_class(errno, err_val)

sqlalchemy.exc.IntegrityError: (asyncmy.errors.IntegrityError) (1048, "Column 'job_name' cannot be null")
[SQL: INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, job_kwargs, job_message, status, exception_info, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ('psi2', 'task_no_dependencies', None, '', '', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', None)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-19 15:24:24.713 |  | INFO     | config.get_redis:close_redis_pool:52 - 关闭redis连接成功
2025-04-19 16:08:43.297 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 16:08:43.299 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 16:08:43.336 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 16:08:43.336 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 16:08:43.341 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 16:08:43.341 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 16:13:38.530 | 370dbf550fc64e19a0f3f786fda01e28 | ERROR    | exceptions.handle:exception_handler:53 - 'JobSchedulerModel' object has no attribute 'job_dependencies'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7343bb30f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7343bb456320>
           └ <SpawnProcess name='SpawnProcess-1' parent=954995 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7343bb455990>
    └ <SpawnProcess name='SpawnProcess-1' parent=954995 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7343bb313430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=954995 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=954995 started>
    │    └ <function subprocess_started at 0x7343bae33b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=954995 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7343bb313550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7343bae32ef0>
           │       │   └ <uvicorn.server.Server object at 0x7343bb313550>
           │       └ <function run at 0x7343bb32e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7343b6da07b0>
           │    └ <cyfunction Loop.run_until_complete at 0x7343b6ce1560>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7343b6dc6080>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b9bae0...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b9b...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7343bb313820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7343b6dc6080>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b9bae0...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b9b...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b9bae0...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b9b...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7343b9bac880>
          └ <fastapi.applications.FastAPI object at 0x7343bb313820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7343b9bb24d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b9b...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7343b9bac910>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7343b9bac880>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7343b9bb2680>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7343b9bb25f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7343b9bac940>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7343b9bac910>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7343b9bb2680>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7343b9bb25f0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7343b9bae260>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7343b6ce72e0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7343b9bac940>
          └ <function wrap_app_handling_exceptions at 0x7343ba1e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b9bb2710>
          │   │      └ <function RequestResponseCycle.receive at 0x7343b9bb25f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7343b6ce72e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b9bb2710>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7343b9bb25f0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7343b6ce72e0>>
          └ <fastapi.routing.APIRouter object at 0x7343b6ce72e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b9bb2710>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7343b9bb25f0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7343ba1e79a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b9bb2710>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7343b9bb25f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7343b6d31750>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b9bb2710>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7343b9bb25f0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7343b9bae3b0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7343b9bb27a0>
          └ <function wrap_app_handling_exceptions at 0x7343ba1e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b9bb2830>
          │   │      └ <function RequestResponseCycle.receive at 0x7343b9bb25f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7343b9bb27a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7343b9bae3b0>
                     └ <function get_request_handler.<locals>.app at 0x7343b6d316c0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7343ba019510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7343b9bae800>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7343b6d30700>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 71, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7343b6d30040>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 91, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 84, in add_task_services
    await task_scheduler.add_task(page_object)
          │              │        └ TaskModel(task_uid='job-alice-bob-041', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │              └ <function TaskScheduler.add_task at 0x7343b6d1be20>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7343b9bae050>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 325, in add_task
    await self.dependency_mgr.register_dependencies(job)
          │    │              │                     └ JobSchedulerModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
          │    │              └ <function DependencyManager.register_dependencies at 0x7343b6d1b760>
          │    └ <module_admin.service.job_service.DependencyManager object at 0x7343b679d5a0>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7343b9bae050>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 208, in register_dependencies
    dependencies = json.loads(job.job_dependencies)
                   │    │     └ JobSchedulerModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
                   │    └ <function loads at 0x7343bb1ca830>
                   └ <module 'json' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/json/__init__....

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/pydantic/main.py", line 994, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'JobSchedulerModel' object has no attribute 'job_dependencies'
2025-04-19 16:13:55.020 | 490ee64a821b406abdd6b4b0acea96a6 | ERROR    | exceptions.handle:exception_handler:53 - name 'AsyncJobUtil' is not defined
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7343bb30f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7343bb456320>
           └ <SpawnProcess name='SpawnProcess-1' parent=954995 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7343bb455990>
    └ <SpawnProcess name='SpawnProcess-1' parent=954995 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7343bb313430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=954995 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=954995 started>
    │    └ <function subprocess_started at 0x7343bae33b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=954995 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7343bb313550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7343bae32ef0>
           │       │   └ <uvicorn.server.Server object at 0x7343bb313550>
           │       └ <function run at 0x7343bb32e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7343b6da07b0>
           │    └ <cyfunction Loop.run_until_complete at 0x7343b6ce1560>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7343b6dc6080>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b67fd8...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b67...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7343bb313820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7343b6dc6080>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b67fd8...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b67...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b67fd8...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b67...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7343b9bac880>
          └ <fastapi.applications.FastAPI object at 0x7343bb313820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7343b9bb2c20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7343b67...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7343b9bac910>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7343b9bac880>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7343b6756d40>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7343b6756cb0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7343b9bac940>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7343b9bac910>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7343b6756d40>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7343b6756cb0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7343b67fde40>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7343b6ce72e0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7343b9bac940>
          └ <function wrap_app_handling_exceptions at 0x7343ba1e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b6756e60>
          │   │      └ <function RequestResponseCycle.receive at 0x7343b6756cb0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7343b6ce72e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b6756e60>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7343b6756cb0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7343b6ce72e0>>
          └ <fastapi.routing.APIRouter object at 0x7343b6ce72e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b6756e60>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7343b6756cb0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7343ba1e79a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b6756e60>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7343b6756cb0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7343b6d31900>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b6756e60>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7343b6756cb0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7343b67fe0e0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7343b6756dd0>
          └ <function wrap_app_handling_exceptions at 0x7343ba1e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7343b6756ef0>
          │   │      └ <function RequestResponseCycle.receive at 0x7343b6756cb0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7343b6756dd0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7343b67fe0e0>
                     └ <function get_request_handler.<locals>.app at 0x7343b6d31990>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7343ba019510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7343b67febf0>, 'task_uid': 'task_no_dependencies', 'req...
                 │         └ <function execute_system_task at 0x7343b6d30a60>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x7343b6d300d0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 187, in execute_task_once_services
    await AsyncJobUtil.add_job_to_redis(query_redis, task_info)
                                        │            └ TaskModel(task_uid='task_no_dependencies', task_name='系统默认（无依赖）', task_initiator='alice', task_group='default', task_yaml=[Jo...
                                        └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,port...

NameError: name 'AsyncJobUtil' is not defined
2025-04-19 16:30:18.657 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 16:30:18.658 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 16:30:18.689 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 16:30:18.689 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 16:30:18.694 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 16:30:18.695 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 16:30:23.246 | cd443bf5a04e4b23a873f17f4aacccbb | ERROR    | exceptions.handle:exception_handler:53 - 'JobSchedulerModel' object has no attribute 'job_dependencies'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x742c317132e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x742c3185a320>
           └ <SpawnProcess name='SpawnProcess-1' parent=962727 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x742c31859990>
    └ <SpawnProcess name='SpawnProcess-1' parent=962727 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x742c31717430>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=962727 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=962727 started>
    │    └ <function subprocess_started at 0x742c311a7b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=962727 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x742c31717550>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x742c311a6ef0>
           │       │   └ <uvicorn.server.Server object at 0x742c31717550>
           │       └ <function run at 0x742c317324d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x742c2d07b1b0>
           │    └ <cyfunction Loop.run_until_complete at 0x742c2d071560>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x742c2ff26050>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x742c2ffd9f...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x742c2ff...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x742c31717820>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x742c2ff26050>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x742c2ffd9f...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x742c2ff...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x742c2ffd9f...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x742c2ff...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x742c2ffd8850>
          └ <fastapi.applications.FastAPI object at 0x742c31717820>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x742c2ffde4d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x742c2ff...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x742c2ffd88e0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x742c2ffd8850>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x742c2ffde680>
          │    │   │      └ <function RequestResponseCycle.receive at 0x742c2ffde5f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x742c2ffd8910>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x742c2ffd88e0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x742c2ffde680>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x742c2ffde5f0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x742c2ffda1a0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x742c2d0772b0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x742c2ffd8910>
          └ <function wrap_app_handling_exceptions at 0x742c305f24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x742c2ffde710>
          │   │      └ <function RequestResponseCycle.receive at 0x742c2ffde5f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x742c2d0772b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x742c2ffde710>
          │    │                │      └ <function RequestResponseCycle.receive at 0x742c2ffde5f0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x742c2d0772b0>>
          └ <fastapi.routing.APIRouter object at 0x742c2d0772b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x742c2ffde710>
          │     │      │      └ <function RequestResponseCycle.receive at 0x742c2ffde5f0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x742c305f39a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x742c2ffde710>
          │    │   │      └ <function RequestResponseCycle.receive at 0x742c2ffde5f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x742c2d0c5900>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x742c2ffde710>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x742c2ffde5f0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x742c2ffda2f0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x742c2ffde7a0>
          └ <function wrap_app_handling_exceptions at 0x742c305f24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x742c2ffde830>
          │   │      └ <function RequestResponseCycle.receive at 0x742c2ffde5f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x742c2ffde7a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x742c2ffda2f0>
                     └ <function get_request_handler.<locals>.app at 0x742c2d0c5990>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x742c30429510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x742c2ffda710>, 'task_uid': 'task_no_dependencies', 'req...
                 │         └ <function execute_system_task at 0x742c2d0c4a60>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x742c2d0c40d0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 188, in execute_task_once_services
    await task_scheduler.add_task(task_info)
          │              │        └ TaskModel(task_uid='task_no_dependencies', task_name='系统默认（无依赖）', task_initiator='alice', task_group='default', task_yaml=[Jo...
          │              └ <function TaskScheduler.add_task at 0x742c2d0afe20>
          └ <module_admin.service.job_service.TaskScheduler object at 0x742c2ffdb460>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 325, in add_task
    await self.dependency_mgr.register_dependencies(job)
          │    │              │                     └ JobSchedulerModel(job_uid='psi1', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
          │    │              └ <function DependencyManager.register_dependencies at 0x742c2d0af760>
          │    └ <module_admin.service.job_service.DependencyManager object at 0x742c2ffdac20>
          └ <module_admin.service.job_service.TaskScheduler object at 0x742c2ffdb460>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 208, in register_dependencies
    dependencies = json.loads(job.job_dependencies)
                   │    │     └ JobSchedulerModel(job_uid='psi1', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
                   │    └ <function loads at 0x742c315ce830>
                   └ <module 'json' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/json/__init__....

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/pydantic/main.py", line 994, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'JobSchedulerModel' object has no attribute 'job_dependencies'
2025-04-19 17:36:24.710 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 17:36:24.711 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 17:36:24.744 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 17:36:24.744 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 17:36:24.749 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 17:36:24.749 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 17:36:27.771 | 1d2f98fe490a4c259f31f77596b161e2 | ERROR    | exceptions.handle:exception_handler:53 - 'JobSchedulerModel' object has no attribute 'job_dependencies'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7b999370f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7b9993856320>
           └ <SpawnProcess name='SpawnProcess-1' parent=985362 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7b9993855990>
    └ <SpawnProcess name='SpawnProcess-1' parent=985362 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7b99937133d0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=985362 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=985362 started>
    │    └ <function subprocess_started at 0x7b9993233b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=985362 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7b99937134f0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7b9993232ef0>
           │       │   └ <uvicorn.server.Server object at 0x7b99937134f0>
           │       └ <function run at 0x7b999372e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7b998f15c7b0>
           │    └ <cyfunction Loop.run_until_complete at 0x7b998f099630>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7b9991f16020>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9991fc5f...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9991f...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7b99937137c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7b9991f16020>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9991fc5f...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9991f...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9991fc5f...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9991f...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7b9991fc4820>
          └ <fastapi.applications.FastAPI object at 0x7b99937137c0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7b9991fca4d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7b9991f...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7b9991fc48b0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7b9991fc4820>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7b9991fca680>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7b9991fca5f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7b9991fc48e0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7b9991fc48b0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7b9991fca680>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7b9991fca5f0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7b9991fc6170>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7b998f0a3280>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7b9991fc48e0>
          └ <function wrap_app_handling_exceptions at 0x7b99925e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9991fca710>
          │   │      └ <function RequestResponseCycle.receive at 0x7b9991fca5f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7b998f0a3280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9991fca710>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7b9991fca5f0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7b998f0a3280>>
          └ <fastapi.routing.APIRouter object at 0x7b998f0a3280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9991fca710>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7b9991fca5f0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7b99925e79a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9991fca710>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7b9991fca5f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7b998f0e9900>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9991fca710>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7b9991fca5f0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7b9991fc62c0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7b9991fca7a0>
          └ <function wrap_app_handling_exceptions at 0x7b99925e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7b9991fca830>
          │   │      └ <function RequestResponseCycle.receive at 0x7b9991fca5f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7b9991fca7a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7b9991fc62c0>
                     └ <function get_request_handler.<locals>.app at 0x7b998f0e9990>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7b9992419510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7b9991fc66e0>, 'task_uid': 'task_no_dependencies', 'req...
                 │         └ <function execute_system_task at 0x7b998f0e8a60>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x7b998f0e80d0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 188, in execute_task_once_services
    await task_scheduler.add_task(task_info)
          │              │        └ TaskModel(task_uid='task_no_dependencies', task_name='系统默认（无依赖）', task_initiator='alice', task_group='default', task_yaml=[Jo...
          │              └ <function TaskScheduler.add_task at 0x7b998f0d7e20>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7b9991fc7430>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 325, in add_task
    await self.dependency_mgr.register_dependencies(job)
          │    │              │                     └ JobSchedulerModel(job_uid='psi1', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
          │    │              └ <function DependencyManager.register_dependencies at 0x7b998f0d7760>
          │    └ <module_admin.service.job_service.DependencyManager object at 0x7b9991fc6bf0>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7b9991fc7430>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 208, in register_dependencies
    dependencies = json.loads(job.job_dependencies)
                   │    │     └ JobSchedulerModel(job_uid='psi1', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
                   │    └ <function loads at 0x7b99935ca830>
                   └ <module 'json' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/json/__init__....

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/pydantic/main.py", line 994, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'JobSchedulerModel' object has no attribute 'job_dependencies'
2025-04-19 17:42:52.064 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 17:42:52.065 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 17:42:52.096 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 17:42:52.096 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 17:42:52.101 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 17:42:52.102 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 17:42:56.132 | 4c5394d022e74e439a4daaee81fe29b8 | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 17:43:08.537 | 70bd7f8df93f40d3bef54bedb2a43225 | INFO     | module_admin.controller.task_controller:query_detail_task:32 - 获取task_uid为task_no_dependencies的信息成功
2025-04-19 17:43:13.427 | c73270a128a644de82bdfafe19333187 | INFO     | module_admin.controller.task_controller:get_task_list:55 - 获取成功
2025-04-19 17:43:24.091 | 20ced35ccafb4efa931c34cfce67dd37 | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 17:45:11.388 | df6c01bd4fdd4d90a729294e1b2d955b | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 17:46:17.988 | 91060c0003f74ec693e6c17d6928e2bc | ERROR    | exceptions.handle:exception_handler:53 - 'TaskProgressModel' object has no attribute 'task_completed'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x738ec8ccb2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x738ec8e5a320>
           └ <SpawnProcess name='SpawnProcess-1' parent=987814 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x738ec8e59990>
    └ <SpawnProcess name='SpawnProcess-1' parent=987814 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x738ec8ccf3d0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=987814 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=987814 started>
    │    └ <function subprocess_started at 0x738ec8773b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=987814 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x738ec8ccf4f0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x738ec8772ef0>
           │       │   └ <uvicorn.server.Server object at 0x738ec8ccf4f0>
           │       └ <function run at 0x738ec8cea4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x738ec74247b0>
           │    └ <cyfunction Loop.run_until_complete at 0x738ec45e9630>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x738ec7445fc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x738ebfd864...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x738ebfd...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x738ec8ccf7c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x738ec7445fc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x738ebfd864...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x738ebfd...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x738ebfd864...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x738ebfd...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x738ec74f47c0>
          └ <fastapi.applications.FastAPI object at 0x738ec8ccf7c0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x738ebfd6dfc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x738ebfd...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x738ec74f4850>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x738ec74f47c0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x738ebfd36680>
          │    │   │      └ <function RequestResponseCycle.receive at 0x738ebfd365f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x738ec74f4880>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x738ec74f4850>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x738ebfd36680>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x738ebfd365f0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x738ebfd87d00>
          │                            │    └ <fastapi.routing.APIRouter object at 0x738ec45f3220>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x738ec74f4880>
          └ <function wrap_app_handling_exceptions at 0x738ec790e4d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x738ec74fa710>
          │   │      └ <function RequestResponseCycle.receive at 0x738ebfd365f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x738ec45f3220>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x738ec74fa710>
          │    │                │      └ <function RequestResponseCycle.receive at 0x738ebfd365f0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x738ec45f3220>>
          └ <fastapi.routing.APIRouter object at 0x738ec45f3220>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x738ec74fa710>
          │     │      │      └ <function RequestResponseCycle.receive at 0x738ebfd365f0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x738ec790f9a0>
          └ APIRoute(path='/monitor/job_complated', name='job_complated', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x738ec74fa710>
          │    │   │      └ <function RequestResponseCycle.receive at 0x738ebfd365f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x738ec4639870>
          └ APIRoute(path='/monitor/job_complated', name='job_complated', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x738ec74fa710>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x738ebfd365f0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x738ebfd86da0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x738ec74fa830>
          └ <function wrap_app_handling_exceptions at 0x738ec790e4d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x738ec74fa7a0>
          │   │      └ <function RequestResponseCycle.receive at 0x738ebfd365f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x738ec74fa830>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x738ebfd86da0>
                     └ <function get_request_handler.<locals>.app at 0x738ec46397e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x738ec7941510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x738ebfd87700>, 'job_complated': JobExecuteResponseModel...
                 │         └ <function job_complated at 0x738ec46388b0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 91, in job_complated
    await task_scheduler.handle_job_completion(job_complated.job_uid, job_complated.success)
          │              │                     │             │        │             └ True
          │              │                     │             │        └ JobExecuteResponseModel(job_uid='psi1', success=True)
          │              │                     │             └ 'psi1'
          │              │                     └ JobExecuteResponseModel(job_uid='psi1', success=True)
          │              └ <function TaskScheduler.handle_job_completion at 0x738ec4627eb0>
          └ <module_admin.service.job_service.TaskScheduler object at 0x738ebfd87730>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 332, in handle_job_completion
    await self.progress_tracker.increment_progress(job.task_uid)
          │    │                │                  │   └ 'task_no_dependencies'
          │    │                │                  └ JobSchedulerModel(job_uid='psi1', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
          │    │                └ <function TaskProgressTracker.increment_progress at 0x738ec46279a0>
          │    └ <module_admin.service.job_service.TaskProgressTracker object at 0x738ebfd873a0>
          └ <module_admin.service.job_service.TaskScheduler object at 0x738ebfd87730>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 248, in increment_progress
    progress.task_completed += 1
    └ TaskProgressModel(task_uid='task_no_dependencies', run_ststus='not started', task_complated=0, task_len=2, task_jobs=['psi1',...

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/pydantic/main.py", line 994, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'TaskProgressModel' object has no attribute 'task_completed'. Did you mean: 'task_complated'?
2025-04-19 17:51:57.549 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 17:51:57.551 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 17:51:57.583 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 17:51:57.584 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 17:51:57.587 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 17:51:57.587 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 17:52:02.973 | e7ef2737208046898ec0834866808c20 | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 17:53:42.250 | 160279df82a44306a75ffeb584c8dbb6 | ERROR    | exceptions.handle:exception_handler:53 - the JSON object must be str, bytes or bytearray, not Pipeline
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7052cb10f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7052cb256320>
           └ <SpawnProcess name='SpawnProcess-1' parent=991637 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7052cb255990>
    └ <SpawnProcess name='SpawnProcess-1' parent=991637 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7052cb1133d0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=991637 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=991637 started>
    │    └ <function subprocess_started at 0x7052cac33b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=991637 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7052cb1134f0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7052cac32ef0>
           │       │   └ <uvicorn.server.Server object at 0x7052cb1134f0>
           │       └ <function run at 0x7052cb12e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7052c6b807b0>
           │    └ <cyfunction Loop.run_until_complete at 0x7052c6abd630>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7052c9919fc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7052c99ca0...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7052c99...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7052cb1137c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7052c9919fc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7052c99ca0...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7052c99...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7052c99ca0...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7052c99...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7052c99c87c0>
          └ <fastapi.applications.FastAPI object at 0x7052cb1137c0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7052c624e680>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7052c99...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7052c99c8850>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7052c99c87c0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7052c99ce4d0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7052c624e5f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7052c99c8880>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7052c99c8850>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7052c99ce4d0>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7052c624e5f0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7052c99ca260>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7052c6ac7220>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7052c99c8880>
          └ <function wrap_app_handling_exceptions at 0x7052c9fe64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7052c99ce680>
          │   │      └ <function RequestResponseCycle.receive at 0x7052c624e5f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7052c6ac7220>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7052c99ce680>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7052c624e5f0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7052c6ac7220>>
          └ <fastapi.routing.APIRouter object at 0x7052c6ac7220>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7052c99ce680>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7052c624e5f0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7052c9fe79a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7052c99ce680>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7052c624e5f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7052c6b0d750>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7052c99ce680>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7052c624e5f0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7052c99ca3e0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7052c99ce5f0>
          └ <function wrap_app_handling_exceptions at 0x7052c9fe64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7052c99ce710>
          │   │      └ <function RequestResponseCycle.receive at 0x7052c624e5f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7052c99ce5f0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7052c99ca3e0>
                     └ <function get_request_handler.<locals>.app at 0x7052c6b0d6c0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7052c9e19510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7052c99ca410>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7052c6b0c700>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 71, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7052c6b0c040>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 91, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 84, in add_task_services
    await task_scheduler.add_task(task_info)
          │              │        └ TaskModel(task_uid='job-alice-bob-042', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │              └ <function TaskScheduler.add_task at 0x7052c6afbe20>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7052c65860b0>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 322, in add_task
    await self.dependency_mgr.register_dependencies(job)
          │    │              │                     └ JobSchedulerModel(job_uid='psi4', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
          │    │              └ <function DependencyManager.register_dependencies at 0x7052c6afb760>
          │    └ <module_admin.service.job_service.DependencyManager object at 0x7052c6297bb0>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7052c65860b0>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 212, in register_dependencies
    await self.redis.add_dependent(dep_job_uid, job.job_uid)
          │    │     │             │            │   └ 'psi4'
          │    │     │             │            └ JobSchedulerModel(job_uid='psi4', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
          │    │     │             └ 'psi3'
          │    │     └ <function RedisJobStore.add_dependent at 0x7052c6afb370>
          │    └ <module_admin.service.job_service.RedisJobStore object at 0x7052c99ca110>
          └ <module_admin.service.job_service.DependencyManager object at 0x7052c6297bb0>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 159, in add_dependent
    dependents = json.loads(await pipe.get(key) or "[]")
                 │    │           │    │   └ 'deps:psi3'
                 │    │           │    └ <function BasicKeyCommands.get at 0x7052c7101fc0>
                 │    │           └ <redis.asyncio.client.Pipeline(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,p...
                 │    └ <function loads at 0x7052cafca830>
                 └ <module 'json' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/json/__init__....

  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/json/__init__.py", line 339, in loads
    raise TypeError(f'the JSON object must be str, bytes or bytearray, '

TypeError: the JSON object must be str, bytes or bytearray, not Pipeline
2025-04-19 17:57:25.941 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 17:57:25.942 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 17:57:25.973 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 17:57:25.973 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 17:57:25.978 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 17:57:25.978 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 17:57:44.620 | c1cbf68d395c44a2af0dc5076fd2c691 | ERROR    | exceptions.handle:exception_handler:53 - the JSON object must be str, bytes or bytearray, not Pipeline
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7d828240f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7d8282556320>
           └ <SpawnProcess name='SpawnProcess-1' parent=993798 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7d8282555990>
    └ <SpawnProcess name='SpawnProcess-1' parent=993798 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7d82824133d0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=993798 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=993798 started>
    │    └ <function subprocess_started at 0x7d8281ea3b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=993798 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7d82824134f0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7d8281ea2ef0>
           │       │   └ <uvicorn.server.Server object at 0x7d82824134f0>
           │       └ <function run at 0x7d828242e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7d827dd831b0>
           │    └ <cyfunction Loop.run_until_complete at 0x7d827dd6d630>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7d8280c2a050>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d8280cddf...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d8280c...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7d82824137c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7d8280c2a050>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d8280cddf...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d8280c...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d8280cddf...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d8280c...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7d8280cdc850>
          └ <fastapi.applications.FastAPI object at 0x7d82824137c0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7d8280ce2440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d8280c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7d8280cdc8e0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7d8280cdc850>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7d8280ce25f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7d8280ce2560>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7d8280cdc910>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7d8280cdc8e0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7d8280ce25f0>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7d8280ce2560>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7d8280cde1d0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7d827dd7b2b0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7d8280cdc910>
          └ <function wrap_app_handling_exceptions at 0x7d82812f24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d8280ce2680>
          │   │      └ <function RequestResponseCycle.receive at 0x7d8280ce2560>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7d827dd7b2b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d8280ce2680>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7d8280ce2560>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7d827dd7b2b0>>
          └ <fastapi.routing.APIRouter object at 0x7d827dd7b2b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d8280ce2680>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7d8280ce2560>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7d82812f39a0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d8280ce2680>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7d8280ce2560>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7d827ddc56c0>
          └ APIRoute(path='/monitor/add_task', name='add_task', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d8280ce2680>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7d8280ce2560>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7d8280cde320>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7d8280ce2710>
          └ <function wrap_app_handling_exceptions at 0x7d82812f24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d8280ce27a0>
          │   │      └ <function RequestResponseCycle.receive at 0x7d8280ce2560>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7d8280ce2710>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7d8280cde320>
                     └ <function get_request_handler.<locals>.app at 0x7d827ddc5630>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7d8281125510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7d8280cde770>, 'add_task': TaskModel(task_uid='job-alic...
                 │         └ <function add_task at 0x7d827ddc4670>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 71, in add_task
    add_task_result = await TaskService.add_task_services(
                            │           └ <classmethod(<function TaskService.add_task_services at 0x7d827ddb3f40>)>
                            └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 91, in add_task_services
    raise e

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 84, in add_task_services
    await task_scheduler.add_task(task_info)
          │              │        └ TaskModel(task_uid='job-alice-bob-043', task_name='task2', task_initiator='alice', task_group='default', task_yaml=[JobModel(...
          │              └ <function TaskScheduler.add_task at 0x7d827ddb3d90>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7d8280cddfc0>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 326, in add_task
    await self.dependency_mgr.register_dependencies(job)
          │    │              │                     └ JobSchedulerModel(job_uid='psi4', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
          │    │              └ <function DependencyManager.register_dependencies at 0x7d827ddb36d0>
          │    └ <module_admin.service.job_service.DependencyManager object at 0x7d827d8195a0>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7d8280cddfc0>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 216, in register_dependencies
    await self.redis.add_dependent(dep_job_uid, job.job_uid)
          │    │     │             │            │   └ 'psi4'
          │    │     │             │            └ JobSchedulerModel(job_uid='psi4', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kw...
          │    │     │             └ 'psi3'
          │    │     └ <function RedisJobStore.add_dependent at 0x7d827ddb32e0>
          │    └ <module_admin.service.job_service.RedisJobStore object at 0x7d827d81a8c0>
          └ <module_admin.service.job_service.DependencyManager object at 0x7d827d8195a0>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 162, in add_dependent
    dependents = json.loads(current_data or b"[]")  # 从结果中解析数据
                 │    │     └ <redis.asyncio.client.Pipeline(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=127.0.0.1,p...
                 │    └ <function loads at 0x7d82822ca830>
                 └ <module 'json' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/json/__init__....

  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/json/__init__.py", line 339, in loads
    raise TypeError(f'the JSON object must be str, bytes or bytearray, '

TypeError: the JSON object must be str, bytes or bytearray, not Pipeline
2025-04-19 18:14:26.810 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 18:14:26.811 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 18:14:26.843 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 18:14:26.844 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 18:14:26.847 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 18:14:26.847 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 18:14:37.746 | c935bfa345af49f0a454c67472a7eaa3 | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 18:15:19.159 | dbf6dae857214d1595ad6b475bfda81d | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 18:18:29.507 | 6fae6fd9bb70423390b85c4a0fde22c4 | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 18:26:11.885 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 18:26:11.885 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 18:26:11.915 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 18:26:11.915 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 18:26:11.919 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 18:26:11.920 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 18:26:29.824 | f9487e16853d4917a27276b0fc433213 | ERROR    | exceptions.handle:exception_handler:53 - name 'job' is not defined
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7d0bf20cb2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7d0bf225a320>
           └ <SpawnProcess name='SpawnProcess-1' parent=1004835 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7d0bf2259990>
    └ <SpawnProcess name='SpawnProcess-1' parent=1004835 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7d0bf20cf3d0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1004835 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1004835 started>
    │    └ <function subprocess_started at 0x7d0bf1b73b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=1004835 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7d0bf20cf4f0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7d0bf1b72ef0>
           │       │   └ <uvicorn.server.Server object at 0x7d0bf20cf4f0>
           │       └ <function run at 0x7d0bf20ea4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7d0bed9f71b0>
           │    └ <cyfunction Loop.run_until_complete at 0x7d0bed9e9630>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7d0bf0841ff0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0bf08f5f...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0bf08...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7d0bf20cf7c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7d0bf0841ff0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0bf08f5f...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0bf08...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0bf08f5f...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0bf08...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7d0bf08f47f0>
          └ <fastapi.applications.FastAPI object at 0x7d0bf20cf7c0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7d0bf08fa560>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7d0bf08...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7d0bf08f4880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7d0bf08f47f0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7d0bf08fa710>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7d0bf08fa680>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7d0bf08f48b0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7d0bf08f4880>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7d0bf08fa710>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7d0bf08fa680>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7d0bf08f6170>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7d0bed9f3250>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7d0bf08f48b0>
          └ <function wrap_app_handling_exceptions at 0x7d0bf0d0a4d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0bf08fa7a0>
          │   │      └ <function RequestResponseCycle.receive at 0x7d0bf08fa680>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7d0bed9f3250>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0bf08fa7a0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7d0bf08fa680>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7d0bed9f3250>>
          └ <fastapi.routing.APIRouter object at 0x7d0bed9f3250>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0bf08fa7a0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7d0bf08fa680>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7d0bf0d0b9a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0bf08fa7a0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7d0bf08fa680>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7d0beda39990>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0bf08fa7a0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7d0bf08fa680>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7d0bf08f62c0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7d0bf08fa830>
          └ <function wrap_app_handling_exceptions at 0x7d0bf0d0a4d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7d0bf08fa8c0>
          │   │      └ <function RequestResponseCycle.receive at 0x7d0bf08fa680>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7d0bf08fa830>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7d0bf08f62c0>
                     └ <function get_request_handler.<locals>.app at 0x7d0beda39a20>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7d0bf0d41510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7d0bf08f66e0>, 'task_uid': 'job-alice-bob-043', 'reques...
                 │         └ <function execute_system_task at 0x7d0beda38af0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x7d0beda38160>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 189, in execute_task_once_services
    await task_scheduler.executor.execute_all_ready_jobs()
          │              │        └ <function JobExecutor.execute_all_ready_jobs at 0x7d0beda2bd00>
          │              └ <module_admin.service.job_service.JobExecutor object at 0x7d0bed4b2350>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7d0bf08f7430>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 298, in execute_all_ready_jobs
    await scheduler.add_jobs([job])
          │         └ <function JobSchedulerService.add_jobs at 0x7d0beda2add0>
          └ <module_admin.service.job_service.JobSchedulerService object at 0x7d0bf08f6a70>

NameError: name 'job' is not defined
2025-04-19 18:26:50.763 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 18:26:50.764 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 18:26:50.817 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 18:26:50.818 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 18:26:50.826 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 18:26:50.827 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 18:27:52.967 | d62648375d674ac09903841e86d9683f | ERROR    | exceptions.handle:exception_handler:53 - name 'job' is not defined
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 14
               └ <function _main at 0x79339ded9f30>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x79339dea11b0>
           └ <SpawnProcess name='SpawnProcess-1' parent=1005355 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x79339dea0820>
    └ <SpawnProcess name='SpawnProcess-1' parent=1005355 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x79339de90eb0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1005355 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1005355 started>
    │    └ <function subprocess_started at 0x79339c08f2e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=1005355 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x79339de90ee0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x79339c04dd80>
           │       │   └ <uvicorn.server.Server object at 0x79339de90ee0>
           │       └ <function run at 0x79339c5bf130>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x793386ad6f80>
           │    └ <cyfunction Loop.run_until_complete at 0x793386a8e4d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x793386b6b2b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7933866b72...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7933866...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x79339deac9a0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x793386b6b2b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7933866b72...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7933866...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7933866b72...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7933866...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7933866b6230>
          └ <fastapi.applications.FastAPI object at 0x79339deac9a0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7933866d1090>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7933866...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7933866b61d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7933866b6230>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7933866d1360>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7933866d12d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7933866b6170>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7933866b61d0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7933866d1360>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7933866d12d0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7933866b77c0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x793386b04a60>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7933866b6170>
          └ <function wrap_app_handling_exceptions at 0x79338e15c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7933866d13f0>
          │   │      └ <function RequestResponseCycle.receive at 0x7933866d12d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x793386b04a60>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7933866d13f0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7933866d12d0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x793386b04a60>>
          └ <fastapi.routing.APIRouter object at 0x793386b04a60>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7933866d13f0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7933866d12d0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x79338e15d7e0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7933866d13f0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7933866d12d0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x793386b02a70>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7933866d13f0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7933866d12d0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7933866b79d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7933866d1480>
          └ <function wrap_app_handling_exceptions at 0x79338e15c280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7933866d1510>
          │   │      └ <function RequestResponseCycle.receive at 0x7933866d12d0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7933866d1480>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7933866b79d0>
                     └ <function get_request_handler.<locals>.app at 0x793386b02b00>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x79338e15f370>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7933866b7df0>, 'task_uid': 'job-alice-bob-043', 'reques...
                 │         └ <function execute_system_task at 0x793386b01b40>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x793386b01480>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 189, in execute_task_once_services
    await task_scheduler.executor.execute_all_ready_jobs()
          │              │        └ <function JobExecutor.execute_all_ready_jobs at 0x793386b01090>
          │              └ <module_admin.service.job_service.JobExecutor object at 0x79338673a860>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7933866b6aa0>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 298, in execute_all_ready_jobs
    await scheduler.add_jobs([job])
          │         └ <function JobSchedulerService.add_jobs at 0x793386b00160>
          └ <module_admin.service.job_service.JobSchedulerService object at 0x79339deb3f10>

NameError: name 'job' is not defined
2025-04-19 18:28:21.755 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 18:28:21.757 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 18:28:21.809 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 18:28:21.810 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 18:28:21.820 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 18:28:21.821 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 18:31:03.514 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 18:31:03.516 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 18:31:03.534 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 18:31:03.534 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 18:31:03.538 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 18:31:03.539 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 18:31:13.500 | 40bf0386b5dc4f4ca980a920f9621d79 | ERROR    | exceptions.handle:exception_handler:53 - (asyncmy.errors.DataError) (1406, "Data too long for column 'status' at row 1")
[SQL: INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, job_kwargs, job_message, status, exception_info, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', None)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x751244ce0040>
    │    └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x751244a6bca0>
    └ <sqlalchemy.engine.base.Connection object at 0x7512453af040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
    │      │       └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
    │      └ <function AsyncAdapt_asyncmy_cursor.execute at 0x7512449180d0>
    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x751241fb9e40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 95, in execute
    return self.await_(self._execute_async(operation, parameters))
           │    │      │    │              │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
           │    │      │    │              └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
           │    │      │    └ <function AsyncAdapt_asyncmy_cursor._execute_async at 0x7512449181f0>
           │    │      └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x751241fb9e40>
           │    └ <member 'await_' of 'AsyncAdapt_asyncmy_cursor' objects>
           └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x751241fb9e40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <coroutine object AsyncAdapt_asyncmy_cursor._execute_async at 0x751245383680>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x7512453ecc80 (otid=0x75124579df80) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <_cython_3_0_11.coroutine object at 0x751242583f60>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 107, in _execute_async
    result = await self._cursor.execute(operation, parameters)
                   │    │               │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
                   │    │               └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
                   │    └ <member '_cursor' of 'AsyncAdapt_asyncmy_cursor' objects>
                   └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x751241fb9e40>
  File "asyncmy/cursors.pyx", line 179, in execute
    result = await self._query(query)
  File "asyncmy/cursors.pyx", line 364, in _query
    await conn.query(q)
  File "asyncmy/connection.pyx", line 496, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "asyncmy/connection.pyx", line 684, in _read_query_result
    await result.read()
  File "asyncmy/connection.pyx", line 1071, in read
    first_packet = await self.connection.read_packet()
  File "asyncmy/connection.pyx", line 646, in read_packet
    packet.raise_for_error()
  File "asyncmy/protocol.pyx", line 190, in asyncmy.protocol.MysqlPacket.raise_for_error
    cpdef raise_for_error(self):
  File "asyncmy/protocol.pyx", line 194, in asyncmy.protocol.MysqlPacket.raise_for_error
    errors.raise_mysql_exception(self._data)
    │      └ <cyfunction raise_mysql_exception at 0x751244b7be00>
    └ <module 'asyncmy.errors' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/asyncmy/errors.c...
  File "asyncmy/errors.pyx", line 128, in asyncmy.errors.raise_mysql_exception
    cpdef raise_mysql_exception(bytes data):
          └ <cyfunction raise_mysql_exception at 0x751244b7be00>
  File "asyncmy/errors.pyx", line 137, in asyncmy.errors.raise_mysql_exception
    raise error_class(errno, err_val)

asyncmy.errors.DataError: (1406, "Data too long for column 'status' at row 1")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x751246b0f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x751246c56320>
           └ <SpawnProcess name='SpawnProcess-1' parent=1007308 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x751246c55990>
    └ <SpawnProcess name='SpawnProcess-1' parent=1007308 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x751246b133d0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1007308 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1007308 started>
    │    └ <function subprocess_started at 0x751246633b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=1007308 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x751246b134f0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x751246632ef0>
           │       │   └ <uvicorn.server.Server object at 0x751246b134f0>
           │       └ <function run at 0x751246b2e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7512425a0820>
           │    └ <cyfunction Loop.run_until_complete at 0x7512424e1630>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7512425c6020>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7512453adf...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7512453...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x751246b137c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7512425c6020>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7512453adf...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7512453...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7512453adf...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7512453...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7512453ac820>
          └ <fastapi.applications.FastAPI object at 0x751246b137c0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7512453b2560>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7512453...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7512453ac8b0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7512453ac820>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7512453b2710>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7512453b2680>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7512453ac8e0>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7512453ac8b0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7512453b2710>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7512453b2680>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7512453ae1a0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7512424eb280>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7512453ac8e0>
          └ <function wrap_app_handling_exceptions at 0x7512459e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7512453b27a0>
          │   │      └ <function RequestResponseCycle.receive at 0x7512453b2680>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7512424eb280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7512453b27a0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7512453b2680>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7512424eb280>>
          └ <fastapi.routing.APIRouter object at 0x7512424eb280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7512453b27a0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7512453b2680>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7512459e79a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7512453b27a0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7512453b2680>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x751242531990>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7512453b27a0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7512453b2680>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7512453ae2f0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7512453b2830>
          └ <function wrap_app_handling_exceptions at 0x7512459e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7512453b28c0>
          │   │      └ <function RequestResponseCycle.receive at 0x7512453b2680>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7512453b2830>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7512453ae2f0>
                     └ <function get_request_handler.<locals>.app at 0x751242531a20>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x751245819510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7512453ae710>, 'task_uid': 'job-alice-bob-043', 'reques...
                 │         └ <function execute_system_task at 0x751242530af0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x751242530160>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 189, in execute_task_once_services
    await task_scheduler.executor.execute_all_ready_jobs()
          │              │        └ <function JobExecutor.execute_all_ready_jobs at 0x75124251fd00>
          │              └ <module_admin.service.job_service.JobExecutor object at 0x751241fa6380>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7512453af460>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 301, in execute_all_ready_jobs
    await JobLogDao.add_job_log_dao(self.db, log)
          │         │               │    │   └ JobLogModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kwargs='...
          │         │               │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7512453ae710>
          │         │               └ <module_admin.service.job_service.JobExecutor object at 0x751241fa6380>
          │         └ <classmethod(<function JobLogDao.add_job_log_dao at 0x751242a509d0>)>
          └ <class 'module_admin.dao.job_log_dao.JobLogDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/job_log_dao.py", line 22, in add_job_log_dao
    await db.flush()
          │  └ <function AsyncSession.flush at 0x751244a93370>
          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7512453ae710>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
          │              │    │            │              └ None
          │              │    │            └ <function Session.flush at 0x7512449cdd80>
          │              │    └ <sqlalchemy.orm.session.Session object at 0x7512453ae7d0>
          │              └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7512453ae710>
          └ <function greenlet_spawn at 0x7512457dd900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             │       │      └ None
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x7512453ecc80 (otid=0x75124579df80) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x7512449cdf30>
    └ <sqlalchemy.orm.session.Session object at 0x7512453ae7d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x751241fdea00>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ DataError('(asyncmy.errors.DataError) (1406, "Data too long for column \'status\' at row 1")')
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x7512449c40d0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7512453aeb30>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x7512453aeb30>
    │   └ <function SaveUpdateAll.execute at 0x7512449c49d0>
    └ SaveUpdateAll(Mapper[SysJobLog(sys_job_log)])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x751244b52e60>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqla...
    │    └ <module 'sqlalchemy.util.preloaded' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlal...
    └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x751244b53880>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x751244e30a60>
             └ <sqlalchemy.engine.base.Connection object at 0x7512453af040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x751241fa7b20>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x751244e30d30>
           └ <sqlalchemy.engine.base.Connection object at 0x7512453af040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x751244e30ee0>
          └ <sqlalchemy.engine.base.Connection object at 0x7512453af040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x751244e30f70>
           └ <sqlalchemy.engine.base.Connection object at 0x7512453af040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x751244e311b0>
    └ <sqlalchemy.engine.base.Connection object at 0x7512453af040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ DataError(1406, "Data too long for column 'status' at row 1")
          │                    │              └ (<class 'asyncmy.errors.DataError'>, DataError(1406, "Data too long for column 'status' at row 1"), <traceback object at 0x75...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ DataError('(asyncmy.errors.DataError) (1406, "Data too long for column \'status\' at row 1")')
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x751244ce0040>
    │    └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x751244a6bca0>
    └ <sqlalchemy.engine.base.Connection object at 0x7512453af040>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
    │      │       └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
    │      └ <function AsyncAdapt_asyncmy_cursor.execute at 0x7512449180d0>
    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x751241fb9e40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 95, in execute
    return self.await_(self._execute_async(operation, parameters))
           │    │      │    │              │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
           │    │      │    │              └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
           │    │      │    └ <function AsyncAdapt_asyncmy_cursor._execute_async at 0x7512449181f0>
           │    │      └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x751241fb9e40>
           │    └ <member 'await_' of 'AsyncAdapt_asyncmy_cursor' objects>
           └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x751241fb9e40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <coroutine object AsyncAdapt_asyncmy_cursor._execute_async at 0x751245383680>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x7512453ecc80 (otid=0x75124579df80) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <_cython_3_0_11.coroutine object at 0x751242583f60>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 107, in _execute_async
    result = await self._cursor.execute(operation, parameters)
                   │    │               │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
                   │    │               └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
                   │    └ <member '_cursor' of 'AsyncAdapt_asyncmy_cursor' objects>
                   └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x751241fb9e40>
  File "asyncmy/cursors.pyx", line 179, in execute
    result = await self._query(query)
  File "asyncmy/cursors.pyx", line 364, in _query
    await conn.query(q)
  File "asyncmy/connection.pyx", line 496, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "asyncmy/connection.pyx", line 684, in _read_query_result
    await result.read()
  File "asyncmy/connection.pyx", line 1071, in read
    first_packet = await self.connection.read_packet()
  File "asyncmy/connection.pyx", line 646, in read_packet
    packet.raise_for_error()
  File "asyncmy/protocol.pyx", line 190, in asyncmy.protocol.MysqlPacket.raise_for_error
    cpdef raise_for_error(self):
  File "asyncmy/protocol.pyx", line 194, in asyncmy.protocol.MysqlPacket.raise_for_error
    errors.raise_mysql_exception(self._data)
    │      └ <cyfunction raise_mysql_exception at 0x751244b7be00>
    └ <module 'asyncmy.errors' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/asyncmy/errors.c...
  File "asyncmy/errors.pyx", line 128, in asyncmy.errors.raise_mysql_exception
    cpdef raise_mysql_exception(bytes data):
          └ <cyfunction raise_mysql_exception at 0x751244b7be00>
  File "asyncmy/errors.pyx", line 137, in asyncmy.errors.raise_mysql_exception
    raise error_class(errno, err_val)

sqlalchemy.exc.DataError: (asyncmy.errors.DataError) (1406, "Data too long for column 'status' at row 1")
[SQL: INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, job_kwargs, job_message, status, exception_info, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', None)]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-04-19 18:40:52.708 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 18:40:52.712 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 18:40:52.757 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 18:40:52.757 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 18:40:52.767 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 18:40:52.768 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 18:42:13.849 | 28256cb5cdbe4d5f92a6b9fa33bff266 | ERROR    | exceptions.handle:exception_handler:53 - (asyncmy.errors.DataError) (1406, "Data too long for column 'status' at row 1")
[SQL: INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, job_kwargs, job_message, status, exception_info, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', datetime.datetime(2025, 4, 19, 18, 42, 13, 812523))]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Traceback (most recent call last):

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x71ecb53bdd80>
    │    └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x71ecb4e40160>
    └ <sqlalchemy.engine.base.Connection object at 0x71ecae0eae90>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
    │      │       └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
    │      └ <function AsyncAdapt_asyncmy_cursor.execute at 0x71ecb4eae0e0>
    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x71ecae0c4900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 95, in execute
    return self.await_(self._execute_async(operation, parameters))
           │    │      │    │              │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
           │    │      │    │              └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
           │    │      │    └ <function AsyncAdapt_asyncmy_cursor._execute_async at 0x71ecb4eae200>
           │    │      └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x71ecae0c4900>
           │    └ <member 'await_' of 'AsyncAdapt_asyncmy_cursor' objects>
           └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x71ecae0c4900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <coroutine object AsyncAdapt_asyncmy_cursor._execute_async at 0x71ecae234270>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x71ecb41b0500 (otid=0x71ecb5aff030) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <_cython_3_0_11.coroutine object at 0x71ecae35b560>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 107, in _execute_async
    result = await self._cursor.execute(operation, parameters)
                   │    │               │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
                   │    │               └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
                   │    └ <member '_cursor' of 'AsyncAdapt_asyncmy_cursor' objects>
                   └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x71ecae0c4900>
  File "asyncmy/cursors.pyx", line 179, in execute
    result = await self._query(query)
  File "asyncmy/cursors.pyx", line 364, in _query
    await conn.query(q)
  File "asyncmy/connection.pyx", line 496, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "asyncmy/connection.pyx", line 684, in _read_query_result
    await result.read()
  File "asyncmy/connection.pyx", line 1071, in read
    first_packet = await self.connection.read_packet()
  File "asyncmy/connection.pyx", line 646, in read_packet
    packet.raise_for_error()
  File "asyncmy/protocol.pyx", line 190, in asyncmy.protocol.MysqlPacket.raise_for_error
    cpdef raise_for_error(self):
  File "asyncmy/protocol.pyx", line 194, in asyncmy.protocol.MysqlPacket.raise_for_error
    errors.raise_mysql_exception(self._data)
    │      └ <cyfunction raise_mysql_exception at 0x71ecb4fa76b0>
    └ <module 'asyncmy.errors' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/asyncmy/errors.c...
  File "asyncmy/errors.pyx", line 128, in asyncmy.errors.raise_mysql_exception
    cpdef raise_mysql_exception(bytes data):
          └ <cyfunction raise_mysql_exception at 0x71ecb4fa76b0>
  File "asyncmy/errors.pyx", line 137, in asyncmy.errors.raise_mysql_exception
    raise error_class(errno, err_val)

asyncmy.errors.DataError: (1406, "Data too long for column 'status' at row 1")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 5
               │     └ 14
               └ <function _main at 0x71ecc5a1df30>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 5
           │    └ <function BaseProcess._bootstrap at 0x71ecc59dd1b0>
           └ <SpawnProcess name='SpawnProcess-1' parent=1011041 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x71ecc59dc820>
    └ <SpawnProcess name='SpawnProcess-1' parent=1011041 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x71ecc59f20e0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1011041 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1011041 started>
    │    └ <function subprocess_started at 0x71ecb6bb32e0>
    └ <SpawnProcess name='SpawnProcess-1' parent=1011041 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x71ecc59f2110>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x71ecb6b71d80>
           │       │   └ <uvicorn.server.Server object at 0x71ecc59f2110>
           │       └ <function run at 0x71ecc4103130>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x71ecae6645f0>
           │    └ <cyfunction Loop.run_until_complete at 0x71ecae76e670>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x71ecae653880>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71ecae39ac...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71ecae3...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x71ecc59d69e0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x71ecae653880>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71ecae39ac...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71ecae3...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71ecae39ac...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71ecae3...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x71ecae39a3e0>
          └ <fastapi.applications.FastAPI object at 0x71ecc59d69e0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x71ecae1b8f70>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x71ecae3...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x71ecae39a380>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x71ecae39a3e0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x71ecae1b9240>
          │    │   │      └ <function RequestResponseCycle.receive at 0x71ecae1b91b0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x71ecae39a320>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x71ecae39a380>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x71ecae1b9240>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x71ecae1b91b0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x71ecae39b970>
          │                            │    └ <fastapi.routing.APIRouter object at 0x71ecae5f08b0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x71ecae39a320>
          └ <function wrap_app_handling_exceptions at 0x71ecb5b78280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71ecae1b92d0>
          │   │      └ <function RequestResponseCycle.receive at 0x71ecae1b91b0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x71ecae5f08b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71ecae1b92d0>
          │    │                │      └ <function RequestResponseCycle.receive at 0x71ecae1b91b0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x71ecae5f08b0>>
          └ <fastapi.routing.APIRouter object at 0x71ecae5f08b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71ecae1b92d0>
          │     │      │      └ <function RequestResponseCycle.receive at 0x71ecae1b91b0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x71ecb5b797e0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71ecae1b92d0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x71ecae1b91b0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x71ecae5ee950>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71ecae1b92d0>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x71ecae1b91b0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x71ecae39bb80>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x71ecae1b9360>
          └ <function wrap_app_handling_exceptions at 0x71ecb5b78280>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x71ecae1b93f0>
          │   │      └ <function RequestResponseCycle.receive at 0x71ecae1b91b0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x71ecae1b9360>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x71ecae39bb80>
                     └ <function get_request_handler.<locals>.app at 0x71ecae5ee9e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x71ecb5b7b370>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x71ecae39bfa0>, 'task_uid': 'job-alice-bob-043', 'reques...
                 │         └ <function execute_system_task at 0x71ecae5eda20>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x71ecae5ed1b0>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 189, in execute_task_once_services
    await task_scheduler.executor.execute_all_ready_jobs()
          │              │        └ <function JobExecutor.execute_all_ready_jobs at 0x71ecae5ecdc0>
          │              └ <module_admin.service.job_service.JobExecutor object at 0x71ecae21cac0>
          └ <module_admin.service.job_service.TaskScheduler object at 0x71ecae39ae60>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 301, in execute_all_ready_jobs
    await JobLogDao.add_job_log_dao(self.db, log)
          │         │               │    │   └ JobLogModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kwargs='...
          │         │               │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x71ecae39bfa0>
          │         │               └ <module_admin.service.job_service.JobExecutor object at 0x71ecae21cac0>
          │         └ <classmethod(<function JobLogDao.add_job_log_dao at 0x71ecaed9a320>)>
          └ <class 'module_admin.dao.job_log_dao.JobLogDao'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/dao/job_log_dao.py", line 22, in add_job_log_dao
    await db.flush()
          │  └ <function AsyncSession.flush at 0x71ecb4e2c8b0>
          └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x71ecae39bfa0>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/ext/asyncio/session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
          │              │    │            │              └ None
          │              │    │            └ <function Session.flush at 0x71ecb4f1dcf0>
          │              │    └ <sqlalchemy.orm.session.Session object at 0x71ecae21c0a0>
          │              └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x71ecae39bfa0>
          └ <function greenlet_spawn at 0x71ecb593d900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             │       │      └ None
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x71ecb41b0500 (otid=0x71ecb5aff030) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x71ecb4f1dea0>
    └ <sqlalchemy.orm.session.Session object at 0x71ecae21c0a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x71ecae0b1740>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ DataError('(asyncmy.errors.DataError) (1406, "Data too long for column \'status\' at row 1")')
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x71ecb50efeb0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x71ecae0ead40>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x71ecae0ead40>
    │   └ <function SaveUpdateAll.execute at 0x71ecb4f14820>
    └ SaveUpdateAll(Mapper[SysJobLog(sys_job_log)])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x71ecb50b2b90>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqla...
    │    └ <module 'sqlalchemy.util.preloaded' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlal...
    └ <module 'sqlalchemy.util' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/sqlalchemy/util...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x71ecb50b35b0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x71ecb54e1750>
             └ <sqlalchemy.engine.base.Connection object at 0x71ecae0eae90>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x71ecae0eb040>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x71ecb54e1a20>
           └ <sqlalchemy.engine.base.Connection object at 0x71ecae0eae90>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x71ecb54e1bd0>
          └ <sqlalchemy.engine.base.Connection object at 0x71ecae0eae90>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x71ecb54e1c60>
           └ <sqlalchemy.engine.base.Connection object at 0x71ecae0eae90>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x71ecb54e1ea0>
    └ <sqlalchemy.engine.base.Connection object at 0x71ecae0eae90>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ DataError(1406, "Data too long for column 'status' at row 1")
          │                    │              └ (<class 'asyncmy.errors.DataError'>, DataError(1406, "Data too long for column 'status' at row 1"), <traceback object at 0x71...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ DataError('(asyncmy.errors.DataError) (1406, "Data too long for column \'status\' at row 1")')
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x71ecb53bdd80>
    │    └ <sqlalchemy.dialects.mysql.asyncmy.MySQLDialect_asyncmy object at 0x71ecb4e40160>
    └ <sqlalchemy.engine.base.Connection object at 0x71ecae0eae90>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
    │      │       └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
    │      └ <function AsyncAdapt_asyncmy_cursor.execute at 0x71ecb4eae0e0>
    └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x71ecae0c4900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 95, in execute
    return self.await_(self._execute_async(operation, parameters))
           │    │      │    │              │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
           │    │      │    │              └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
           │    │      │    └ <function AsyncAdapt_asyncmy_cursor._execute_async at 0x71ecb4eae200>
           │    │      └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x71ecae0c4900>
           │    └ <member 'await_' of 'AsyncAdapt_asyncmy_cursor' objects>
           └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x71ecae0c4900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           │       │             └ <coroutine object AsyncAdapt_asyncmy_cursor._execute_async at 0x71ecae234270>
           │       └ <attribute 'parent' of 'greenlet.greenlet' objects>
           └ <_AsyncIoGreenlet object at 0x71ecb41b0500 (otid=0x71ecb5aff030) dead>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  └ <_cython_3_0_11.coroutine object at 0x71ecae35b560>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/sqlalchemy/dialects/mysql/asyncmy.py", line 107, in _execute_async
    result = await self._cursor.execute(operation, parameters)
                   │    │               │          └ ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始...
                   │    │               └ 'INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, ...
                   │    └ <member '_cursor' of 'AsyncAdapt_asyncmy_cursor' objects>
                   └ <sqlalchemy.dialects.mysql.asyncmy.AsyncAdapt_asyncmy_cursor object at 0x71ecae0c4900>
  File "asyncmy/cursors.pyx", line 179, in execute
    result = await self._query(query)
  File "asyncmy/cursors.pyx", line 364, in _query
    await conn.query(q)
  File "asyncmy/connection.pyx", line 496, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "asyncmy/connection.pyx", line 684, in _read_query_result
    await result.read()
  File "asyncmy/connection.pyx", line 1071, in read
    first_packet = await self.connection.read_packet()
  File "asyncmy/connection.pyx", line 646, in read_packet
    packet.raise_for_error()
  File "asyncmy/protocol.pyx", line 190, in asyncmy.protocol.MysqlPacket.raise_for_error
    cpdef raise_for_error(self):
  File "asyncmy/protocol.pyx", line 194, in asyncmy.protocol.MysqlPacket.raise_for_error
    errors.raise_mysql_exception(self._data)
    │      └ <cyfunction raise_mysql_exception at 0x71ecb4fa76b0>
    └ <module 'asyncmy.errors' from '/disc/home/beng003/work/DAGScheduler\u200b/.venv/lib/python3.10/site-packages/asyncmy/errors.c...
  File "asyncmy/errors.pyx", line 128, in asyncmy.errors.raise_mysql_exception
    cpdef raise_mysql_exception(bytes data):
          └ <cyfunction raise_mysql_exception at 0x71ecb4fa76b0>
  File "asyncmy/errors.pyx", line 137, in asyncmy.errors.raise_mysql_exception
    raise error_class(errno, err_val)

sqlalchemy.exc.DataError: (asyncmy.errors.DataError) (1406, "Data too long for column 'status' at row 1")
[SQL: INSERT INTO sys_job_log (job_uid, task_uid, job_name, job_parties, job_dependencies, job_executor, invoke_target, job_args, job_kwargs, job_message, status, exception_info, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]
[parameters: ('psi3', 'job-alice-bob-043', 'psi1', '["party1","party2"]', '[]', 'default', 'module_task.scheduler_test.job', '', '', '任务开始执行', 'success', '', datetime.datetime(2025, 4, 19, 18, 42, 13, 812523))]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-04-19 18:42:57.471 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 18:42:57.472 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 18:42:57.497 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 18:42:57.497 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 18:42:57.502 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 18:42:57.503 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 18:43:04.186 | 80e438f7cd0b41e3ac5af85c8a5f18f7 | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 18:43:43.688 | 2bef6086e4e0457584e51f272035a06c | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 18:51:58.738 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 18:51:58.740 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 18:51:58.778 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 18:51:58.779 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 18:51:58.783 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 18:51:58.784 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 18:52:04.810 | 3e8977231ef64809bea61f0806eed51f | ERROR    | exceptions.handle:exception_handler:53 - 'str' object has no attribute 'decode'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7dd7c900f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7dd7c9156320>
           └ <SpawnProcess name='SpawnProcess-1' parent=1015408 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7dd7c9155990>
    └ <SpawnProcess name='SpawnProcess-1' parent=1015408 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7dd7c90133d0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1015408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1015408 started>
    │    └ <function subprocess_started at 0x7dd7c8aa3b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=1015408 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7dd7c90134f0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7dd7c8aa2ef0>
           │       │   └ <uvicorn.server.Server object at 0x7dd7c90134f0>
           │       └ <function run at 0x7dd7c902e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7dd7c780c820>
           │    └ <cyfunction Loop.run_until_complete at 0x7dd7c496d630>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7dd7c782dfc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7dd7c78ddf...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7dd7c78...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7dd7c90137c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7dd7c782dfc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7dd7c78ddf...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7dd7c78...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7dd7c78ddf...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7dd7c78...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7dd7c78dc7c0>
          └ <fastapi.applications.FastAPI object at 0x7dd7c90137c0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7dd7c78e24d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7dd7c78...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7dd7c78dc850>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7dd7c78dc7c0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7dd7c78e2680>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7dd7c78e25f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7dd7c78dc880>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7dd7c78dc850>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7dd7c78e2680>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7dd7c78e25f0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7dd7c78de140>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7dd7c497f250>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7dd7c78dc880>
          └ <function wrap_app_handling_exceptions at 0x7dd7c7ef64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7dd7c78e2710>
          │   │      └ <function RequestResponseCycle.receive at 0x7dd7c78e25f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7dd7c497f250>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7dd7c78e2710>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7dd7c78e25f0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7dd7c497f250>>
          └ <fastapi.routing.APIRouter object at 0x7dd7c497f250>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7dd7c78e2710>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7dd7c78e25f0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7dd7c7ef79a0>
          └ APIRoute(path='/monitor/job_complated', name='job_complated', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7dd7c78e2710>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7dd7c78e25f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7dd7c49c1870>
          └ APIRoute(path='/monitor/job_complated', name='job_complated', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7dd7c78e2710>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7dd7c78e25f0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7dd7c78de290>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7dd7c78e27a0>
          └ <function wrap_app_handling_exceptions at 0x7dd7c7ef64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7dd7c78e2830>
          │   │      └ <function RequestResponseCycle.receive at 0x7dd7c78e25f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7dd7c78e27a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7dd7c78de290>
                     └ <function get_request_handler.<locals>.app at 0x7dd7c49c17e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7dd7c7d29510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7dd7c78de6e0>, 'job_complated': JobExecuteResponseModel...
                 │         └ <function job_complated at 0x7dd7c49c08b0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 91, in job_complated
    await task_scheduler.handle_job_completion(job_complated.job_uid, job_complated.success)
          │              │                     │             │        │             └ True
          │              │                     │             │        └ JobExecuteResponseModel(job_uid='psi4', success=True)
          │              │                     │             └ 'psi4'
          │              │                     └ JobExecuteResponseModel(job_uid='psi4', success=True)
          │              └ <function TaskScheduler.handle_job_completion at 0x7dd7c49b3eb0>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7dd7c78de680>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 356, in handle_job_completion
    await self.executor.execute_all_ready_jobs()  # 触发后续任务执行
          │    │        └ <function JobExecutor.execute_all_ready_jobs at 0x7dd7c49b3c70>
          │    └ <module_admin.service.job_service.JobExecutor object at 0x7dd7c78de980>
          └ <module_admin.service.job_service.TaskScheduler object at 0x7dd7c78de680>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 301, in execute_all_ready_jobs
    job_uids = await self.redis.get_all_ready_jobs()
                     │    │     └ <function RedisJobStore.get_all_ready_jobs at 0x7dd7c49b31c0>
                     │    └ <module_admin.service.job_service.RedisJobStore object at 0x7dd7c78de6b0>
                     └ <module_admin.service.job_service.JobExecutor object at 0x7dd7c78de980>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 149, in get_all_ready_jobs
    job_uids.append(job_uid.decode("utf-8"))
    │        │      └ 'psi3'
    │        └ <method 'append' of 'list' objects>
    └ []

AttributeError: 'str' object has no attribute 'decode'. Did you mean: 'encode'?
2025-04-19 18:52:33.733 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 18:52:33.734 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 18:52:33.766 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 18:52:33.766 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 18:52:33.769 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 18:52:33.769 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 18:53:20.758 | 055a1a0e75a64c14a71d54e93b485fb2 | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 18:54:34.604 |  | INFO     | config.get_redis:close_redis_pool:52 - 关闭redis连接成功
2025-04-19 19:02:15.276 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 19:02:15.276 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 19:02:15.314 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 19:02:15.315 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 19:02:15.320 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 19:02:15.320 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 19:02:27.564 | 996401e6dc5447e0b7f1603461dd8df3 | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 19:02:48.926 | 317e2c9fc2f14f1cbf57a3d8f9c04e2c | ERROR    | exceptions.handle:exception_handler:53 - 'TaskSchedulerService' object has no attribute 'db'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x7afef590f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7afef5a56320>
           └ <SpawnProcess name='SpawnProcess-1' parent=1019672 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7afef5a55990>
    └ <SpawnProcess name='SpawnProcess-1' parent=1019672 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7afef59133d0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1019672 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1019672 started>
    │    └ <function subprocess_started at 0x7afef5433b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=1019672 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7afef59134f0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x7afef5432ef0>
           │       │   └ <uvicorn.server.Server object at 0x7afef59134f0>
           │       └ <function run at 0x7afef592e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7afef135c970>
           │    └ <cyfunction Loop.run_until_complete at 0x7afef129d630>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7afef4115fc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afef41c5f...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afef41...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7afef59137c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7afef4115fc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afef41c5f...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afef41...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afef41c5f...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afef41...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7afef41c47c0>
          └ <fastapi.applications.FastAPI object at 0x7afef59137c0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7afef0a4a9e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7afef41...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7afef41c4850>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7afef41c47c0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7afef41ca4d0>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7afef0a4aa70>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7afef41c4880>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x7afef41c4850>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x7afef41ca4d0>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x7afef0a4aa70>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7afef41c5450>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7afef12ab250>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7afef41c4880>
          └ <function wrap_app_handling_exceptions at 0x7afef47e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afef41ca680>
          │   │      └ <function RequestResponseCycle.receive at 0x7afef0a4aa70>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7afef12ab250>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afef41ca680>
          │    │                │      └ <function RequestResponseCycle.receive at 0x7afef0a4aa70>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7afef12ab250>>
          └ <fastapi.routing.APIRouter object at 0x7afef12ab250>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afef41ca680>
          │     │      │      └ <function RequestResponseCycle.receive at 0x7afef0a4aa70>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x7afef47e79a0>
          └ APIRoute(path='/monitor/job_complated', name='job_complated', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afef41ca680>
          │    │   │      └ <function RequestResponseCycle.receive at 0x7afef0a4aa70>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x7afef12e9870>
          └ APIRoute(path='/monitor/job_complated', name='job_complated', methods=['POST'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afef41ca680>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x7afef0a4aa70>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7afef41c5510>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7afef41ca5f0>
          └ <function wrap_app_handling_exceptions at 0x7afef47e64d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7afef41ca710>
          │   │      └ <function RequestResponseCycle.receive at 0x7afef0a4aa70>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7afef41ca5f0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7afef41c5510>
                     └ <function get_request_handler.<locals>.app at 0x7afef12e97e0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7afef4619510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x7afef41c6200>, 'job_complated': JobExecuteResponseModel...
                 │         └ <function job_complated at 0x7afef12e88b0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 91, in job_complated
    await task_scheduler.handle_job_completion(job_complated.job_uid, job_complated.success)
          │              │                     │             │        │             └ True
          │              │                     │             │        └ JobExecuteResponseModel(job_uid='psi3', success=True)
          │              │                     │             └ 'psi3'
          │              │                     └ JobExecuteResponseModel(job_uid='psi3', success=True)
          │              └ <function TaskSchedulerService.handle_job_completion at 0x7afef12dbeb0>
          └ <module_admin.service.job_service.TaskSchedulerService object at 0x7afef41c60e0>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 358, in handle_job_completion
    await JobLogDao.add_job_log_dao(self.db, log)
          │         │               │        └ JobLogModel(job_uid='psi3', job_executor='default', invoke_target='module_task.scheduler_test.job', job_args='', job_kwargs='...
          │         │               └ <module_admin.service.job_service.TaskSchedulerService object at 0x7afef41c60e0>
          │         └ <classmethod(<function JobLogDao.add_job_log_dao at 0x7afef17f89d0>)>
          └ <class 'module_admin.dao.job_log_dao.JobLogDao'>

AttributeError: 'TaskSchedulerService' object has no attribute 'db'
2025-04-19 19:03:44.460 |  | INFO     | config.get_redis:close_redis_pool:52 - 关闭redis连接成功
2025-04-19 19:17:15.422 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 19:17:15.423 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 19:17:15.455 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 19:17:15.455 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 19:17:15.460 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 19:17:15.461 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 19:17:34.703 | 73aa91a6eaa1476ea127bffa733940c1 | ERROR    | exceptions.handle:exception_handler:53 - 1 validation error for JobLogModel
status
  Input should be '0' or '1' [type=literal_error, input_value=0, input_type=int]
    For further information visit https://errors.pydantic.dev/2.11/v/literal_error
Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 13
               └ <function _main at 0x784d97d0f2e0>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x784d97e56320>
           └ <SpawnProcess name='SpawnProcess-1' parent=1025214 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x784d97e55990>
    └ <SpawnProcess name='SpawnProcess-1' parent=1025214 started>
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x784d97d133d0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1025214 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1025214 started>
    │    └ <function subprocess_started at 0x784d97833b50>
    └ <SpawnProcess name='SpawnProcess-1' parent=1025214 started>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x784d97d134f0>>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 9099)>]
           │       │   │    └ <function Server.serve at 0x784d97832ef0>
           │       │   └ <uvicorn.server.Server object at 0x784d97d134f0>
           │       └ <function run at 0x784d97d2e4d0>
           └ <module 'asyncio' from '/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/__i...
  File "/disc/home/beng003/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x784d8f6373e0>
           │    └ <cyfunction Loop.run_until_complete at 0x784d8f6297d0>
           └ <uvloop.Loop running=True closed=False debug=False>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x784d96515fc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x784d965c9f...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x784d965...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x784d97d137c0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x784d96515fc0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x784d965c9f...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x784d965...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x784d965c9f...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x784d965...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x784d965c87c0>
          └ <fastapi.applications.FastAPI object at 0x784d97d137c0>
> File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x784d965ce4d0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x784d965...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x784d965c8850>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x784d965c87c0>

  File "/disc/home/beng003/work/DAGScheduler​/middlewares/trace_middleware/middle.py", line 62, in __call__
    await self.app(scope, handle_outgoing_receive, handle_outgoing_request)
          │    │   │      │                        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x784d965ce680>
          │    │   │      └ <function RequestResponseCycle.receive at 0x784d965ce5f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x784d965c8880>
          └ <middlewares.trace_middleware.middle.TraceASGIMiddleware object at 0x784d965c8850>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function TraceASGIMiddleware.__call__.<locals>.handle_outgoing_request at 0x784d965ce680>
          │                            │    │    │     │      └ <function RequestResponseCycle.receive at 0x784d965ce5f0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x784d965ca140>
          │                            │    └ <fastapi.routing.APIRouter object at 0x784d8f63f250>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x784d965c8880>
          └ <function wrap_app_handling_exceptions at 0x784d96be24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x784d965ce710>
          │   │      └ <function RequestResponseCycle.receive at 0x784d965ce5f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <fastapi.routing.APIRouter object at 0x784d8f63f250>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x784d965ce710>
          │    │                │      └ <function RequestResponseCycle.receive at 0x784d965ce5f0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x784d8f63f250>>
          └ <fastapi.routing.APIRouter object at 0x784d8f63f250>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x784d965ce710>
          │     │      │      └ <function RequestResponseCycle.receive at 0x784d965ce5f0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │     └ <function Route.handle at 0x784d96be39a0>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x784d965ce710>
          │    │   │      └ <function RequestResponseCycle.receive at 0x784d965ce5f0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │    └ <function request_response.<locals>.app at 0x784d8f685870>
          └ APIRoute(path='/monitor/task/start/{task_uid}', name='execute_system_task', methods=['PUT'])
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x784d965ce710>
          │                            │    │        │      └ <function RequestResponseCycle.receive at 0x784d965ce5f0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x784d965ca290>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x784d965ce7a0>
          └ <function wrap_app_handling_exceptions at 0x784d96be24d0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x784d965ce830>
          │   │      └ <function RequestResponseCycle.receive at 0x784d965ce5f0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 9099), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x784d965ce7a0>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x784d965ca290>
                     └ <function get_request_handler.<locals>.app at 0x784d8f685900>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x784d96a19510>
  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'query_db': <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x784d965ca6b0>, 'task_uid': 'job-alice-bob-043', 'reques...
                 │         └ <function execute_system_task at 0x784d8f6849d0>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='task_uid', mode='validation')], query_params=[], ...

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/controller/task_controller.py", line 107, in execute_system_task
    execute_task_result = await TaskService.execute_task_once_services(
                                │           └ <classmethod(<function TaskService.execute_task_once_services at 0x784d8f684040>)>
                                └ <class 'module_admin.service.task_service.TaskService'>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/task_service.py", line 189, in execute_task_once_services
    await task_scheduler.executor.execute_all_ready_jobs()
          │              │        └ <function JobExecutor.execute_all_ready_jobs at 0x784d8f673be0>
          │              └ <module_admin.service.job_service.JobExecutor object at 0x784d8f0fa320>
          └ <module_admin.service.job_service.TaskSchedulerService object at 0x784d965cb400>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 311, in execute_all_ready_jobs
    await self.add_job_log(job_uid, "任务开始执行", 0, commit=False)
          │    │           └ 'psi3'
          │    └ <function JobExecutor.add_job_log at 0x784d8f673c70>
          └ <module_admin.service.job_service.JobExecutor object at 0x784d8f0fa320>

  File "/disc/home/beng003/work/DAGScheduler​/module_admin/service/job_service.py", line 324, in add_job_log
    log = JobLogModel(
          └ <class 'module_admin.entity.vo.task_vo.JobLogModel'>

  File "/disc/home/beng003/work/DAGScheduler​/.venv/lib/python3.10/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     │    │                      │               │                   └ JobLogModel()
                     │    │                      │               └ {'job_uid': 'psi3', 'job_executor': 'default', 'invoke_target': 'module_task.scheduler_test.job', 'job_args': '', 'job_kwargs...
                     │    │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
                     │    └ SchemaValidator(title="JobLogModel", validator=Model(
                     │          ModelValidator {
                     │              revalidate: Never,
                     │              validator: Mode...
                     └ JobLogModel()

pydantic_core._pydantic_core.ValidationError: 1 validation error for JobLogModel
status
  Input should be '0' or '1' [type=literal_error, input_value=0, input_type=int]
    For further information visit https://errors.pydantic.dev/2.11/v/literal_error
2025-04-19 19:18:22.155 |  | INFO     | server:lifespan:17 - RuoYi-FastAPI开始启动
2025-04-19 19:18:22.156 |  | INFO     | config.get_db:init_create_table:23 - 初始化数据库连接...
2025-04-19 19:18:22.180 |  | INFO     | config.get_db:init_create_table:26 - 数据库连接成功
2025-04-19 19:18:22.180 |  | INFO     | config.get_redis:create_redis_pool:19 - 开始连接redis...
2025-04-19 19:18:22.183 |  | INFO     | config.get_redis:create_redis_pool:32 - redis连接成功
2025-04-19 19:18:22.183 |  | INFO     | server:lifespan:22 - RuoYi-FastAPI启动成功
2025-04-19 19:18:27.197 | 851a747ed881499e8d27995c45592e63 | INFO     | module_admin.controller.task_controller:execute_system_task:110 - 执行成功
2025-04-19 19:19:37.879 |  | INFO     | config.get_redis:close_redis_pool:52 - 关闭redis连接成功
